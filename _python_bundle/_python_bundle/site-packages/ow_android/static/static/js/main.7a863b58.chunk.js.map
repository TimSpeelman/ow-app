{"version":3,"sources":["assets/images/qr-scan.svg","hooks/useMenu.tsx","hooks/usePromised.ts","hooks/useServices.tsx","components/Icon.tsx","components/Sidemenu.tsx","util/fallbackBool.ts","components/Button.tsx","components/CredentialCard.tsx","components/SubpageHeader.tsx","hooks/useInternationalization.tsx","pages/VerifieeConsentPage.tsx","demo.tsx","components/SelectInput.tsx","hooks/useLocalState.tsx","pages/CredentialCreatePage.tsx","pages/ProcedureDonePage.tsx","hooks/useSelector.ts","util/memoizeFn.ts","services/local/selectors.ts","pages/ReceiveAttributesPage.tsx","services/RequestProcedureFlowRunner.ts","pages/ShareRequestPage.tsx","util/Hook.ts","services/ProviderService.ts","services/AttributeService.ts","services/local/LocalAPI.ts","services/local/LocalState.ts","services/OpenWalletService.ts","util/timer.ts","util/Interval.ts","services/ReferenceService.ts","services/services.ts","flows/CredentialCreateFlow.tsx","services/CredentialVerifyFlowRunner.ts","pages/VerifierConsentPage.tsx","flows/CredentialVerifyFlow.tsx","modules/QR/GenericDecoding.ts","pages/ConfirmContactPage.tsx","pages/ConfirmIncomingVerificationPage.tsx","pages/ContactDetailPage.tsx","components/ContactCard.tsx","pages/ContactIndexPage.tsx","components/BottomTools.tsx","modules/QR/QREncoding.ts","services/QRService.ts","pages/CredentialDetailPage.tsx","hooks/useQR.ts","hooks/useClock.ts","components/HomepageHeader.tsx","pages/CredentialIndexPage.tsx","pages/DebugPage.tsx","pages/QrReaderPage.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","Context","createContext","useMenu","useContext","usePromised","promisable","useState","undefined","result","setResult","useEffect","then","useServices","Icon","children","props","className","Object","keys","Sidemenu","open","setOpen","toggleMenu","v","bools","find","b","fallbackBool","isOpen","SidemenuNo","services","path","myMid","ipv8Service","api","getMyId","catch","e","console","error","peers","setPeers","i","setInterval","observer","peerPoller","cache","clearInterval","classNames","onClick","times","to","id-card","users","info-circle","cog","length","map","p","substr","join","Button","isPending","primary","classnames","pending","secondary","CredentialCard","style","width","src","imageUrl","alt","title","issuerName","withQRs","onDisplayQR","qrcode","showDetails","value","qrValue","text","size","level","showMeta","metadata","key","toString","SubpageHeader","openMenu","SubpageHeaderNo","backUrl","chevron-left","pageTitle","bars","useInternationalization","VerifieeConsentPage","request","onSubmitConsent","fromLanguageDict","setPending","handleSubmit","consent","attrs","success","resolve","attributes","filter","a","status","results","ambiguous","missing","attribute","name","hash","signer_mid_b64","disabled","DemoPage","verifier_id","ref","format","responses","SelectInput","onChange","target","emptyMessage","hidden","options","o","label","useLocalState","CredentialCreatePage","onSubmitRequest","langCode","state","provider","setProvider","procedure","setProcedure","providers","useMemo","id","sort","formatProviders","procedures","provId","prov","values","recipes","recipe","formatRecipes","provStatus","indexOf","mid_b64","provOnline","ProcedureDonePage","messageTitle","messageBody","_s","useSelector","selector","context","log","memoizeUnary","fn","thisArg","cachedI","cachedO","arg","apply","getAttributes","getProviderByMid","getProviders","mid","Step","Status","ReceiveAttributesPage","receiveRequest","attributesToReceive","logo_url","ShareRequestPage","shareRequest","receiver","allAttributes","attributesToShare","attributeNames","Hook","listeners","this","forEach","l","listener","push","unsubscribe","hook","on","fire","OnlineStatus","RequestProcedureFlowRunner","providersService","walletService","attributeService","step","INIT","PENDING","hookStep","hookUserConsentToReceive","hookStatus","providerKey","procedureKey","message","requirements","executeProcedure","askUserToShare","abortProcedure","saveReceivedCredentials","setStep","SHARE","onConsent","data","askUserToReceive","Promise","requestOWAttestSharingApproved","storeAttribute","showMessage","setStatus","COMPLETE","done","ABORTED","FAILED","reason","RECEIVE","DONE","msg","verify_request","AttributesService","attr","s","store","LocalAPI","axios","get","d","put","LocalState","localApi","stateChangeHook","defaultState","_state","fetch","getState","response","updateState","putState","newState","OpenWalletService","localState","ipv8","recipeClient","providerId","procedureId","onConsentStore","dataToShare","reduce","c","process","createProcess","listAttestations","myAtts","vResp","x","attribute_name","attribute_hash","request_hash","subject_id","myId","allowVerification","recipeRequest","createRequest","Axios","post","service_endpoint","httpResponse","offer","attester_id","validateOffer","warn","requestAttestation","attrDesc","time","Date","now","provider_title","type","Error","ProviderService","online","ONLINE","pingForOnline","timeInMillis","race","getByURL","url","setTimeout","isOnline","OFFLINE","r","details","addOrUpdate","Interval","index","intervalHandle","handler","ms","ReferenceService","handles","handle","ReferenceHandle","onDestroy","removeHandle","h","references","freshRefHook","invalidationHook","destroyHook","interval","listen","createNewReference","millis","start","stop","stopRefreshing","expireReference","uuid","millisToExpire","destroyWhenNoReferences","destroy","portFromUrl","window","location","match","cookie","Cookies","port","set","localhostBase","localAPI","create","baseURL","IPv8","IPv8Service","callbackService","peercalls","memberId","refId","resolveReference","flow","owService","CredentialCreateFlow","pv","pc","userStartsRequest","userConsentsToShare","userConsentsToReceive","VerifierConsentPage","verificationOffer","attribute_value","CredentialVerifyFlowRunner","verifierService","verifyOffer","CONFIRM","verify","showVerificationResult","DecodeStatus","CredentialVerifyFlow","userConsentsToVerify","MultiDecoder","decoders","obj","decode","Succeeded","Failed","Unmatched","DecoderChain","decodeA","decodeB","ConfirmContactPage","description","website","confirmRequest","denyRequest","React","Component","ConfirmIncomingVerificationPage","ContactDetailPage","providerMid","href","ContactCard","logoUrl","ContactIndexPage","contactUrl","setContactUrl","encodeURIComponent","onSubmit","addByURL","alert","finally","saveContact","placeholder","required","BottomTools","showQR","fontSize","require","showPlus","plus","QRDecodeError","QRX","payload","decodeSucceded","decodeFailed","MultiQRDecoder","stringDecoder","domainDecoders","decoder","str","SimpleQRStringCodec","qrx","split","INVALID_FORMAT","VerificationOfferCodec","TYPE","JSON","stringify","parse","INVALID_PAYLOAD","qrDecoder","encodeVerifOffer","encoder","strEncoder","encode","makeEncoder","CredentialDetailPage","useReferenceQR","selectedQR","setSelectedQR","onPeerScan","callbackId","referenceForPeer","callback","setValue","register","onNewReference","refreshAtInterval","refreshIntervalMillis","destroyOnUnmount","useCallbackReference","millisPerTick","setTime","useClock","expiresAt","expirationInSeconds","HomepageHeader","HomepageHeaderNo","CredentialIndexPage","DebugPage","attReqs","atts","verifReqs","verifs","polls","setPolls","attReqPoller","attPoller","verifReqPoller","verifPoller","value_hash","probability","QrReaderPage","onScanQR","lastScan","setLastScan","manualInput","setManualInput","showManual","setShowManual","delay","onError","err","onScan","AppBody","ready","history","useHistory","SpecificCredentialVerifyFlow","SpecificCredentialDetailPage","SpecificContactDetailPage","val","res","params","useParams","decodeURIComponent","Boolean","hostname","root","initServices","setContext","setError","Provider","owVerifiee","OpenWallet","OWVerifiee","verifieeService","owAttestee","OWAttestee","attesteeService","Recipe","RecipeClient","priority","fallbackLangs","setLanguage","translate","dict","availableLanguages","chosenLanguage","available","lang","pickLanguage","setState","ReactDOM","render","document","getElementById","navigator","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.7a863b58.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/qr-scan.c24fd00a.svg\";","import React, { createContext, useContext, useState } from \"react\";\r\n\r\n/** The Context object available to consumers */\r\nexport interface MenuContext {\r\n    open: boolean;\r\n    setOpen: (to: boolean) => void;\r\n}\r\n\r\n// Create a react context with dummy default value\r\nconst Context = createContext<MenuContext>({} as MenuContext);\r\n\r\nexport const MenuContextProvider: React.FC = ({ children }) => {\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const context = {\r\n        open,\r\n        setOpen,\r\n    }\r\n\r\n    return <Context.Provider value={context}>{children}</Context.Provider>\r\n}\r\n\r\nexport const useMenu = () => {\r\n    return useContext(Context);\r\n};\r\n\r\n","import { useEffect, useState } from \"react\";\r\n\r\nexport function usePromised<T>(promisable: () => Promise<T>) {\r\n    const [result, setResult] = useState<T | undefined>(undefined);\r\n\r\n    useEffect(() => { promisable().then(setResult); }, []);\r\n\r\n    return result;\r\n}","import { IPv8Service } from \"@tsow/ow-ssi/dist/types/src/ipv8/IPv8Service\";\r\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { AttributesService } from \"../services/AttributeService\";\r\nimport { LocalAPI } from \"../services/local/LocalAPI\";\r\nimport { LocalState } from \"../services/local/LocalState\";\r\nimport { OpenWalletService } from \"../services/OpenWalletService\";\r\nimport { ProviderService } from \"../services/ProviderService\";\r\nimport { ReferenceService } from \"../services/ReferenceService\";\r\nimport { PeerCallback } from \"../services/services\";\r\n\r\n/** The Context object available to consumers */\r\nexport interface ServiceList {\r\n    localAPI: LocalAPI;\r\n    localState: LocalState;\r\n    ipv8Service: IPv8Service;\r\n    attributeService: AttributesService;\r\n    callbackService: ReferenceService<PeerCallback>;\r\n    providersService: ProviderService;\r\n    owService: OpenWalletService;\r\n}\r\n\r\nexport interface ServicesContext {\r\n    ready: boolean;\r\n    error: boolean;\r\n    services: ServiceList | null;\r\n    path: string;\r\n}\r\n\r\n\r\n// Create a react context with dummy default value\r\nconst Context = createContext<ServicesContext>({} as ServicesContext);\r\n\r\nexport const ServicesContextProvider: React.FC<Props> = ({ children, initServices, path }) => {\r\n    const [services, setContext] = useState<ServiceList | null>(null);\r\n    const [error, setError] = useState<any>(null);\r\n\r\n    useEffect(() => {\r\n        initServices().then(s => setContext(s)).catch(setError);\r\n    }, []);\r\n\r\n    const context = {\r\n        ready: !!services,\r\n        error,\r\n        services,\r\n        path\r\n    }\r\n\r\n    return <Context.Provider value={context}>{children}</Context.Provider>\r\n}\r\n\r\nexport const useServices = () => {\r\n    return useContext(Context);\r\n};\r\n\r\ninterface Props {\r\n    initServices: () => Promise<ServiceList>\r\n    path: string;\r\n}","import React from 'react';\r\n\r\nexport const Icon: React.FC<any> = ({ children, ...props }) => (\r\n    <span className={`fas fa-${Object.keys(props)[0]}`}></span>\r\n)\r\n\r\ninterface Props {\r\n    children: string;\r\n}","import classNames from \"classnames\";\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { useMenu } from \"../hooks/useMenu\";\r\nimport { usePromised } from \"../hooks/usePromised\";\r\nimport { useServices } from \"../hooks/useServices\";\r\nimport { fallbackBool } from \"../util/fallbackBool\";\r\nimport { Icon } from \"./Icon\";\r\n\r\n\r\nexport const Sidemenu: React.FC = () => {\r\n    const { open, setOpen } = useMenu();\r\n\r\n    return <SidemenuNo toggleMenu={(v) => setOpen(fallbackBool(v, open))} isOpen={open} />\r\n}\r\n\r\nexport const SidemenuNo: React.FC<Props> = ({ toggleMenu, isOpen }: Props) => {\r\n    const { services, path } = useServices();\r\n    const myMid = usePromised(() => services!.ipv8Service.api.getMyId().catch(e => console.error(e)));\r\n\r\n    const [peers, setPeers] = useState<string[]>([])\r\n\r\n    useEffect(() => {\r\n        const i = setInterval(() => setPeers(services!.ipv8Service.observer.peerPoller.cache), 300)\r\n        return () => clearInterval(i);\r\n    })\r\n\r\n    return (\r\n        <div className={classNames({ \"side-menu-open\": isOpen })}>\r\n            <div className=\"side-menu-close\" onClick={() => toggleMenu(false)}>\r\n                <Icon times />\r\n            </div>\r\n\r\n            <div className=\"side-menu-backdrop\" onClick={() => toggleMenu(false)}></div>\r\n\r\n            <div className=\"side-menu\">\r\n                <ul>\r\n                    <li>\r\n                        <Link to=\"/attestations\" onClick={() => toggleMenu(false)}>\r\n                            <Icon id-card /><span>Credentials</span>\r\n                        </Link>\r\n                    </li>\r\n                    <li>\r\n                        <Link to=\"/contacts\" onClick={() => toggleMenu(false)}>\r\n                            <Icon users /><span>Contacts</span>\r\n                        </Link>\r\n                    </li>\r\n                    <li>\r\n                        <Link to=\"/\" onClick={() => toggleMenu(false)} className=\"disabled\">\r\n                            <Icon info-circle /><span>About</span>\r\n                        </Link>\r\n                    </li>\r\n                    <li>\r\n                        <Link to=\"/\" onClick={() => toggleMenu(false)} className=\"disabled\">\r\n                            <Icon cog /><span>Settings</span>\r\n                        </Link>\r\n                    </li>\r\n                    <p><strong>Debug Information:</strong></p>\r\n                    <p>Using agent: {path}</p>\r\n                    <p>Using mid: {myMid}</p>\r\n                    <p>Known peers: {peers.length} ({peers.map(p => p.substr(0, 5)).join(\", \")})</p>\r\n                </ul>\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    toggleMenu: (v?: boolean) => any,\r\n    isOpen: boolean,\r\n}","\r\nexport const fallbackBool = (...bools: (boolean | undefined)[]) => bools.find(b => b === true || b === false) || false;\r\n","import classnames from \"classnames\";\r\nimport React, { ReactElement } from \"react\";\r\n\r\nexport const Button: React.FC<Props> = ({ onClick, isPending, primary, children, ...props }: Props) => (\r\n    <button  {...props} onClick={onClick} className={classnames([\"btn\", { pending: isPending, primary: primary, secondary: !primary }])}>\r\n        <span>{children}</span>\r\n        <div className=\"lds-ellipsis\">\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n        </div>\r\n    </button>\r\n)\r\n\r\ninterface Props {\r\n    onClick?: (newVal: any) => any;\r\n    isPending?: boolean;\r\n    children?: string | ReactElement;\r\n    primary?: boolean;\r\n    disabled?: boolean;\r\n    type?: \"button\" | \"reset\" | \"submit\";\r\n}\r\n","import QRCode from \"qrcode.react\";\r\nimport React, { ReactElement } from 'react';\r\nimport CopyToClipboard from \"react-copy-to-clipboard\";\r\nimport { Icon } from \"./Icon\";\r\n\r\nexport const CredentialCard: React.FC<Props> = (p) => (\r\n\r\n    <div className=\"card-item\">\r\n        <div className=\"row\">\r\n            <div className=\"logo-box\">\r\n                <img style={{ width: \"80%\" }} src={p.imageUrl} alt=\"\" />\r\n            </div>\r\n            <div className=\"text-box\">\r\n                <div className=\"primary\">{p.title}</div>\r\n                <div className=\"secondary\">{p.issuerName}</div>\r\n            </div>\r\n            {!p.withQRs ? \"\" :\r\n                <div className=\"tool\">\r\n                    <span onClick={() => p.onDisplayQR && p.onDisplayQR(p.title)}><Icon qrcode /></span>\r\n                </div>\r\n            }\r\n        </div>\r\n\r\n        {!p.showDetails ? \"\" : (\r\n            <div className=\"credential-details\">\r\n                <div className=\"row\">\r\n                    <div className=\"text-box\">\r\n                        <div className=\"primary\">{p.title}</div>\r\n                        <div className=\"secondary\">{p.value}</div>\r\n                    </div>\r\n                    {!p.withQRs ? \"\" :\r\n                        <div className=\"tool\">\r\n                            <span onClick={() => p.onDisplayQR && p.onDisplayQR(p.title)}><Icon qrcode /></span>\r\n                        </div>\r\n                    }\r\n                </div>\r\n            </div>\r\n        )}\r\n\r\n        {!p.withQRs || !p.qrValue ? \"\" : (\r\n\r\n            <div className=\"qr-code\">\r\n                <CopyToClipboard text={p.qrValue}>\r\n                    <QRCode value={p.qrValue} size={256} level={\"M\"} />\r\n                </CopyToClipboard>\r\n            </div>\r\n\r\n        )}\r\n\r\n        {!p.showMeta ? \"\" : (\r\n\r\n            <div className=\"credential-meta\">\r\n                <table>\r\n                    <tbody>\r\n                        {(p.metadata || []).map(e => (\r\n                            <tr key={e.key.toString()}>\r\n                                <td>{e.key}</td>\r\n                                <td>{e.value}</td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        )}\r\n\r\n    </div>\r\n\r\n);\r\n\r\n\r\ninterface Props {\r\n    imageUrl: string;\r\n    title: string;\r\n    issuerName: string;\r\n    value?: string;\r\n    withQRs?: boolean;\r\n    showDetails?: boolean;\r\n    showMeta?: boolean;\r\n    qrValue?: string;\r\n    metadata?: Array<{ key: string | ReactElement, value: string | ReactElement }>;\r\n    onDisplayQR?: (qr: string) => any;\r\n}\r\n","\r\nimport React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useMenu } from \"../hooks/useMenu\";\r\nimport { Icon } from \"./Icon\";\r\n\r\n\r\nexport const SubpageHeader: React.FC<Omit<Props, \"openMenu\">> = (p) => {\r\n    const { setOpen } = useMenu();\r\n\r\n    return <SubpageHeaderNo openMenu={() => setOpen(true)} {...p} />\r\n}\r\n\r\nexport const SubpageHeaderNo: React.FC<Props> = (p: Props) => (\r\n    <div>\r\n        <header>\r\n            <div className=\"content\">\r\n                <Link className=\"back-arrow\" to={p.backUrl}><Icon chevron-left /></Link>\r\n\r\n                <div className=\"page-title\">{p.pageTitle}</div>\r\n\r\n                <div className=\"burger-menu\" onClick={p.openMenu}>\r\n                    <Icon bars />\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div className=\"background\"></div>\r\n        </header>\r\n\r\n        <div className=\"after-header\"> </div>\r\n    </div>\r\n)\r\n\r\ninterface Props {\r\n    backUrl: string;\r\n    pageTitle: string;\r\n    openMenu: () => any;\r\n}\r\n","import React, { createContext, FC, useContext, useState } from \"react\";\r\nimport { Dict } from \"../types/Dict\";\r\n\r\n/** The context object for i18n */\r\nexport interface I18nContext {\r\n    langCode: string;\r\n    setLanguage: (lang: string) => void;\r\n    translate: KeyTranslator;\r\n    fromLanguageDict: DictionaryTranslator;\r\n}\r\n\r\nconst Context = createContext<I18nContext>({} as I18nContext);\r\n\r\n/** Provider that creates and handles state */\r\nexport const I18nContextProvider: FC<Props> = ({ children, fallbackLangs }) => {\r\n    const [langCode, setLanguage] = useState<string>(\"nl_NL\");\r\n\r\n    const context = {\r\n        langCode,\r\n        setLanguage,\r\n        translate: (id: string) => id, // Currently cannot translate\r\n        fromLanguageDict: pickFromDictionary([langCode, ...fallbackLangs]),\r\n    };\r\n\r\n    return <Context.Provider value={context}>{children}</Context.Provider>;\r\n}\r\n\r\ninterface Props {\r\n    /** \r\n     * The language that will be used if Wallet content (like attributes)\r\n     * does not have a translation for the current language.\r\n     */\r\n    fallbackLangs: string[];\r\n}\r\n\r\nexport const useInternationalization = () => {\r\n    return useContext(Context);\r\n};\r\n\r\nexport type KeyTranslator = (key: string) => string\r\nexport type DictionaryTranslator = (dict: Dict<string>) => string\r\n\r\n/**\r\n * Picks from a list of available languages the first\r\n * according to a priority, or otherwise the first of\r\n * the available languages.\r\n */\r\nfunction pickLanguage(available: string[], priority: string[]) {\r\n    const lang = priority.find(p => available.indexOf(p) >= 0)\r\n    return lang ? lang : available[0];\r\n}\r\n\r\nfunction pickFromDictionary(priority: string[]) {\r\n    return (dict: Dict<string>) => {\r\n        const availableLanguages = Object.keys(dict);\r\n        const chosenLanguage = pickLanguage(availableLanguages, priority);\r\n\r\n        return dict[chosenLanguage];\r\n    }\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Button } from \"../components/Button\";\r\nimport { CredentialCard } from \"../components/CredentialCard\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { InformedVerifyRequest } from \"../types/InformedVerifyRequest\";\r\n\r\nexport const VerifieeConsentPage: React.FC<Props> = ({ request, onSubmitConsent }) => {\r\n    const { fromLanguageDict } = useInternationalization();\r\n\r\n    const [pending, setPending] = useState(false);\r\n\r\n    const handleSubmit = (consent: boolean) => {\r\n        setPending(true);\r\n        onSubmitConsent(consent);\r\n    }\r\n\r\n    const attrs = {\r\n        success: request.resolve.attributes.filter(a => a.status === \"success\").map(a => a.results[0]),\r\n        ambiguous: request.resolve.attributes.filter(a => a.status === \"ambiguous\"),\r\n        missing: request.resolve.attributes.filter(a => a.status === \"missing\"),\r\n    }\r\n\r\n    return (\r\n        <div className=\"subpage nav-compact\">\r\n            <SubpageHeader\r\n                pageTitle={\"Consent to Share\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main className=\"text-center\">\r\n                <h1>Do you wish to share?</h1>\r\n                {attrs.missing.length > 0 && (\r\n                    <div>\r\n                        <p>You are missing the following attributes:</p>\r\n                        <ul>\r\n                            {attrs.missing.map(attribute =>\r\n                                <li>{attribute.request.name}</li>\r\n                            )}\r\n                        </ul>\r\n                    </div>\r\n                )}\r\n\r\n                {/* TODO AMBIGUOUS */}\r\n\r\n                <p>X requires the following information:</p>\r\n\r\n                {attrs.success.map(attribute =>\r\n                    <CredentialCard\r\n                        key={attribute.hash}\r\n                        title={attribute.name}\r\n                        issuerName={attribute.signer_mid_b64}\r\n                        imageUrl={\"\"}\r\n                        value={attribute.value}\r\n                        showDetails\r\n                    />\r\n                )}\r\n\r\n                <p>Do you wish to share these credentials?</p>\r\n                <Button onClick={() => handleSubmit(true)} isPending={pending} primary >Share these credentials</Button>\r\n                <Button onClick={() => handleSubmit(false)} disabled={pending} >Do not share</Button>\r\n            </main>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    request: InformedVerifyRequest,\r\n    onSubmitConsent: (consent: boolean) => any\r\n}\r\n","import React from 'react';\r\nimport './assets/css/font-awesome.min.css';\r\nimport './assets/css/index.css';\r\nimport { VerifieeConsentPage } from \"./pages/VerifieeConsentPage\";\r\nimport { InformedVerifyRequest } from \"./types/InformedVerifyRequest\";\r\n\r\nexport const DemoPage: React.FC = () => {\r\n\r\n    const request: InformedVerifyRequest = {\r\n        request: {\r\n            attributes: [],\r\n            verifier_id: \"VRFID\",\r\n        },\r\n        resolve: {\r\n            status: \"success\",\r\n            attributes: [\r\n                {\r\n                    status: \"success\",\r\n                    ref: \"a\",\r\n                    request: { name: \"name\", format: \"id_metadata\", ref: \"a\" },\r\n                    results: [\r\n                        { hash: \"xsd\", value: \"Tim Speelman\", format: \"id_metadata\", name: \"name\", signer_mid_b64: \"xyz\", metadata: 1 }\r\n                    ],\r\n                    responses: [{ hash: \"xsd\", ref: \"a\", }],\r\n                },\r\n                {\r\n                    status: \"success\",\r\n                    ref: \"a\",\r\n                    request: { name: \"age\", format: \"id_metadata\", ref: \"a\" },\r\n                    results: [\r\n                        { hash: \"xsd\", value: \"28\", format: \"id_metadata\", name: \"age\", signer_mid_b64: \"xyz\", metadata: 1 }\r\n                    ],\r\n                    responses: [{ hash: \"xsd\", ref: \"a\", }],\r\n                }\r\n            ]\r\n        },\r\n    }\r\n    return (\r\n        <VerifieeConsentPage onSubmitConsent={() => { }} request={request} />\r\n    )\r\n}\r\n","import React, { ReactElement } from \"react\";\r\n\r\nexport const SelectInput: React.FC<Props> = (p: Props) => (\r\n    <select value={p.value} onChange={(e) => p.onChange(e.target.value)}>\r\n        {!p.emptyMessage ? \"\" : <option value={\"\"} disabled hidden>{p.emptyMessage}</option>}\r\n        {p.options.map(o => (\r\n            <option value={o.value} key={o.value}>{o.label}</option>\r\n        ))}\r\n    </select>\r\n)\r\n\r\ninterface Props {\r\n    value: any;\r\n    onChange: (newVal: any) => any;\r\n    options: Array<SelectOption>;\r\n    emptyMessage?: ReactElement | string;\r\n}\r\n\r\nexport interface SelectOption {\r\n    value: any;\r\n    label: ReactElement | string;\r\n}\r\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { LocalState } from \"../services/local/LocalState\";\r\nimport { IState } from \"../types/State\";\r\n\r\n/** The Context object available to consumers */\r\nexport interface LocalStateContext {\r\n    state: IState;\r\n}\r\n\r\n// Create a react context with dummy default value\r\nconst Context = createContext<LocalStateContext>({} as LocalStateContext);\r\n\r\nexport const LocalStateContextProvider: React.FC<{ localState: LocalState }> = ({ localState, children }) => {\r\n    const [state, setState] = useState<IState>(localState.state);\r\n\r\n    // Register to the changes to local state\r\n    useEffect(() => {\r\n        localState.stateChangeHook.on(setState);\r\n    }, [localState])\r\n\r\n    return <Context.Provider value={{ state }}>{children}</Context.Provider>\r\n}\r\n\r\nexport const useLocalState = () => {\r\n    return useContext(Context);\r\n};\r\n\r\n","import { Recipe } from \"@tsow/ow-ssi\";\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { Button } from \"../components/Button\";\r\nimport { SelectInput, SelectOption } from \"../components/SelectInput\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { useLocalState } from \"../hooks/useLocalState\";\r\nimport { useServices } from \"../hooks/useServices\";\r\nimport { Dict } from \"../types/Dict\";\r\n\r\nexport const CredentialCreatePage: React.FC<Props> = ({ onSubmitRequest }) => {\r\n\r\n    const { langCode } = useInternationalization();\r\n    const { state } = useLocalState();\r\n    const { services } = useServices();\r\n\r\n    const [provider, setProvider] = useState<string>(\"\");\r\n    const [procedure, setProcedure] = useState<string>(\"\");\r\n    const [pending, setPending] = useState(false);\r\n\r\n    // Clear the chosen procedure once user changes the provider\r\n    useEffect(() => setProcedure(\"\"), [provider]);\r\n\r\n    const [peers, setPeers] = useState<string[]>([])\r\n\r\n    useEffect(() => {\r\n        const i = setInterval(() => setPeers(services!.ipv8Service.observer.peerPoller.cache), 300)\r\n        return () => clearInterval(i);\r\n    })\r\n\r\n    const providers = useMemo(() => formatProviders(state.providers, langCode), [state.providers, langCode]);\r\n    const procedures = useMemo(() => formatRecipes(state.providers, provider, langCode), [state.providers, provider, langCode]);\r\n\r\n    const handleSubmit = () => {\r\n        setPending(true);\r\n        onSubmitRequest(provider, procedure);\r\n    }\r\n\r\n    const provStatus =\r\n        peers.length === 0 ? \"No peers known!\"\r\n            : provider == \"\" ? \"\"\r\n                : !state.providers[provider] ? \"Unknown provider selected\"\r\n                    : peers.indexOf(state.providers[provider].mid_b64) >= 0 ? \"Provider Online\"\r\n                        : \"Provider Offline\";\r\n    const provOnline = peers.indexOf(state.providers[provider]?.mid_b64) >= 0\r\n\r\n    return (\r\n        <div className=\"subpage nav-compact\">\r\n            <SubpageHeader\r\n                pageTitle={\"Request Credential\"}\r\n                backUrl={\"/\"}\r\n            />\r\n            <main className=\"text-center\">\r\n                <h1>Request new credentials</h1>\r\n\r\n\r\n                {providers.length === 0 ? (\r\n                    <div>\r\n                        <p>You don't know any providers yet.. Please add one to your\r\n                        contacts first.</p>\r\n\r\n                        <Link to=\"/contacts\"><Button primary>Go to contacts</Button></Link>\r\n                    </div>\r\n                ) : (\r\n                        <div>\r\n                            <p>Please pick a provider and the credential you wish to obtain.</p>\r\n\r\n                            <SelectInput\r\n                                options={providers}\r\n                                value={provider}\r\n                                onChange={setProvider}\r\n                                emptyMessage={\"Select a provider please\"}\r\n                            />\r\n                        </div>\r\n                    )}\r\n\r\n                {!provider ? \"\" :\r\n                    <SelectInput\r\n                        options={procedures}\r\n                        value={procedure}\r\n                        onChange={setProcedure}\r\n                        emptyMessage={\"Select your attribute\"}\r\n                    />\r\n                }\r\n\r\n                <br />\r\n                <br />\r\n\r\n                <p>{provStatus}</p>\r\n\r\n                {!provider || !procedure ? \"\" : <Button onClick={handleSubmit} isPending={pending} disabled={!provOnline || !provider || !procedure}>\r\n                    Request Attribute</Button>}\r\n            </main>\r\n        </div>\r\n\r\n    )\r\n\r\n}\r\n\r\n\r\nfunction formatProviders(providers: Dict<Recipe.RecipeServiceDescriptor>, langCode: string): SelectOption[] {\r\n    return Object.keys(providers).map(key =>\r\n        ({\r\n            value: providers[key].id,\r\n            label: providers[key].title[langCode],\r\n        })).sort((a, b) => a.label > b.label ? -1 : 1);\r\n}\r\n\r\nfunction formatRecipes(providers: Dict<Recipe.RecipeServiceDescriptor>, provId: string, langCode: string): SelectOption[] {\r\n    const prov = providers[provId];\r\n    if (!prov) return [];\r\n    const recipes = Object.values(prov.recipes);\r\n    return recipes.map(recipe =>\r\n        ({\r\n            value: recipe.name,\r\n            label: recipe.title[langCode],\r\n        })).sort((a, b) => a.label > b.label ? -1 : 1);\r\n}\r\n\r\ninterface Props {\r\n    onSubmitRequest: (providerId: string, procedureId: string) => any;\r\n}","import React from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { Button } from \"../components/Button\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\n\r\nexport const ProcedureDonePage: React.FC<Props> = ({ pageTitle, messageTitle, messageBody }) => {\r\n    return (\r\n        <div className=\"subpage nav-compact\">\r\n\r\n            <SubpageHeader\r\n                pageTitle={pageTitle}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main className=\"text-center\" >\r\n                <h1>{messageTitle}</h1>\r\n                <p>{messageBody}</p>\r\n\r\n                <Link to=\"/\"><Button>OK</Button></Link>\r\n            </main>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    pageTitle: string;\r\n    messageTitle: string;\r\n    messageBody: string;\r\n}","import { IState } from \"../types/State\";\r\nimport { useLocalState } from \"./useLocalState\";\r\n\r\nlet _s: any = null;\r\n\r\nexport function useSelector<T>(selector: (state: IState) => T) {\r\n    const context = useLocalState();\r\n    if (_s !== context.state) console.log(\"useSelector: STATE updated\");\r\n    _s = context.state;\r\n    return selector(context.state);\r\n}","/**\r\n * Memoize a unary function. Caches the argument and return value of a call to\r\n * this function. When the argument is the same as in the previous call, it will\r\n * return the cached return value without invoking the function again.\r\n *\r\n * This is useful for functions that return a new object with the same contents\r\n * in each call, while we prefer to have the exact same object.\r\n */\r\nexport function memoizeUnary<I, O>(fn: (arg: I) => O, thisArg: any): (arg: I) => O {\r\n    let cachedI: I;\r\n    let cachedO: O;\r\n    return (arg: I) => {\r\n        if (cachedI !== undefined && cachedI === arg) {\r\n            return cachedO;\r\n        } else {\r\n            cachedI = arg;\r\n            cachedO = fn.apply(thisArg, [arg]);\r\n            return cachedO;\r\n        }\r\n    };\r\n}\r\n\r\n/**\r\n * Memoize a binary function. Caches the arguments and return value of a call to\r\n * this function. When the arguments are the same as in the previous call, it will\r\n * return the cached return value without invoking the function again.\r\n *\r\n * This is useful for functions that return a new object with the same contents\r\n * in each call, while we prefer to have the exact same object.\r\n */\r\nexport function memoizeBinary<I1, I2, O>(fn: (arg1: I1, arg2: I2) => O, thisArg: any): (arg1: I1, arg2: I2) => O {\r\n    let cachedI1: I1;\r\n    let cachedI2: I2;\r\n    let cachedO: O;\r\n    return (arg1: I1, arg2: I2) => {\r\n        if (cachedI1 !== undefined && cachedI1 === arg1 &&\r\n            cachedI2 !== undefined && cachedI2 === arg2) {\r\n            return cachedO;\r\n        } else {\r\n            cachedI1 = arg1;\r\n            cachedI2 = arg2;\r\n            cachedO = fn.apply(thisArg, [arg1, arg2]);\r\n            return cachedO;\r\n        }\r\n    };\r\n}\r\n","import { Recipe } from \"@tsow/ow-ssi\";\r\nimport { IState, LocalAttribute } from \"../../types/State\";\r\nimport { memoizeUnary } from \"../../util/memoizeFn\";\r\n\r\nexport function getAttributes(state: IState): Array<LocalAttribute & WithProvider> {\r\n    return state.attributes.map(a => ({\r\n        ...a,\r\n        provider: getProviderByMid(a.signer_mid_b64)(state)!,\r\n    }));\r\n}\r\n\r\nexport function getAttributeByHash(hash: string) {\r\n    return memoizeUnary((state: IState) => {\r\n        return getAttributes(state).find(a => a.hash === hash);\r\n    }, null);\r\n}\r\n\r\nexport function getProviders(state: IState) {\r\n    return Object.values(state.providers);\r\n}\r\n\r\nexport function getProviderByMid(mid: string) {\r\n    return memoizeUnary((state: IState) => {\r\n        const result = Object.values(state.providers).find(p => p.mid_b64 === mid);\r\n        return result;\r\n    }, null);\r\n}\r\n\r\ninterface WithProvider {\r\n    provider: Recipe.RecipeServiceDescriptor\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Button } from \"../components/Button\";\r\nimport { CredentialCard } from \"../components/CredentialCard\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { useSelector } from \"../hooks/useSelector\";\r\nimport { getProviderByMid } from \"../services/local/selectors\";\r\nimport { AttributeReceiveRequest } from \"../types/types\";\r\n\r\nexport const ReceiveAttributesPage: React.FC<Props> = ({ receiveRequest, onSubmitConsent }) => {\r\n    const { fromLanguageDict } = useInternationalization();\r\n\r\n    const provider = useSelector(getProviderByMid(receiveRequest.provider));\r\n\r\n    const [pending, setPending] = useState(false);\r\n\r\n    const attributesToReceive = receiveRequest.attributes;\r\n\r\n\r\n    const handleSubmit = (consent: boolean) => {\r\n        setPending(true);\r\n        onSubmitConsent(consent);\r\n    }\r\n\r\n    return !receiveRequest ? <div>...ReceiveAttributesPage...</div> : (\r\n        <div className=\"subpage nav-compact\">\r\n\r\n            <SubpageHeader\r\n                pageTitle={\"Receive Credentials\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main className=\"text-center\" >\r\n                <h1>Step 2: Save New Credentials</h1>\r\n                <p>{fromLanguageDict(provider!.title)} offers you the following credentials:</p>\r\n\r\n                {attributesToReceive.map(attribute => (\r\n                    <CredentialCard\r\n                        key={attribute.name}\r\n                        title={fromLanguageDict(attribute.title)}\r\n                        issuerName={fromLanguageDict(provider!.title)}\r\n                        imageUrl={provider!.logo_url}\r\n                        value={attribute.value}\r\n                        showDetails={true}\r\n                        showMeta={true}\r\n                        metadata={[\r\n                            { key: \"Signed by\", value: fromLanguageDict(provider!.title) },\r\n                            { key: \"Created at\", value: \"2018-09-01 13:20:00 CET\" },\r\n                            { key: \"Valid until\", value: \"2020-09-01 13:20:00 CET\" },\r\n                        ]} />\r\n                ))}\r\n\r\n                <p>Do you wish to save these credentials?</p>\r\n                <Button onClick={() => handleSubmit(true)} primary isPending={pending}>Save these credentials</Button>\r\n                <Button onClick={() => handleSubmit(false)} disabled={pending}>Do not save</Button>\r\n            </main>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    receiveRequest: AttributeReceiveRequest;\r\n    onSubmitConsent: (consent: boolean) => any;\r\n}","import { Recipe } from \"@tsow/ow-ssi\";\r\nimport { AttributeReceiveRequest, AttributeShareRequest } from \"../types/types\";\r\nimport { Hook } from \"../util/Hook\";\r\nimport { AttributesService } from \"./AttributeService\";\r\nimport { OpenWalletService } from \"./OpenWalletService\";\r\nimport { ProviderService } from \"./ProviderService\";\r\n\r\nexport enum Step { INIT, SHARE, RECEIVE, DONE };\r\nexport enum Status { PENDING, COMPLETE, ABORTED, FAILED };\r\n\r\nexport class RequestProcedureFlowRunner {\r\n    public step: Step = Step.INIT;\r\n    public status: Status = Status.PENDING;\r\n    public hookStep: Hook<Step> = new Hook();\r\n    public hookUserConsentToReceive: Hook<boolean> = new Hook();\r\n    public hookStatus: Hook<Status> = new Hook();\r\n\r\n    private providerKey?: string;\r\n    private procedureKey?: string;\r\n\r\n    public message: string = \"\";\r\n\r\n    constructor(\r\n        private providersService: ProviderService,\r\n        private walletService: OpenWalletService,\r\n        private attributeService: AttributesService,\r\n    ) { }\r\n\r\n    get provider(): Recipe.RecipeServiceDescriptor | null {\r\n        return this.providerKey ? this.providersService.providers[this.providerKey] : null;\r\n    }\r\n\r\n    get procedure() {\r\n        return this.provider && this.procedureKey &&\r\n            this.provider.recipes[this.procedureKey];\r\n    }\r\n\r\n    get requirements() {\r\n        return this.procedure && (this.procedure.verify_request?.attributes || [])\r\n            .map(a => a.name);\r\n    }\r\n\r\n    get shareRequest(): AttributeShareRequest | null {\r\n        if (!this.requirements) return null;\r\n        return {\r\n            attributeNames: this.requirements,\r\n            done: () => { },\r\n            id: \"\",\r\n            reason: \"Some reason\",\r\n            receiver: this.provider!.mid_b64,\r\n        }\r\n    }\r\n\r\n    public receiveRequest: AttributeReceiveRequest | null = null;\r\n\r\n    userStartsRequest(providerKey: string, procedureKey: string) {\r\n        this.providerKey = providerKey;\r\n        this.procedureKey = procedureKey;\r\n        if (this.requirements && this.requirements.length === 0) {\r\n            this.executeProcedure();\r\n        } else {\r\n            this.askUserToShare();\r\n        }\r\n    }\r\n\r\n    userConsentsToShare(consent: boolean) {\r\n        if (consent) {\r\n            this.executeProcedure();\r\n        } else {\r\n            this.abortProcedure();\r\n        }\r\n    }\r\n\r\n    userConsentsToReceive(consent: boolean) {\r\n        this.hookUserConsentToReceive.fire(consent);\r\n\r\n        if (consent) {\r\n            this.saveReceivedCredentials();\r\n        } else {\r\n            this.abortProcedure();\r\n        }\r\n    }\r\n\r\n    protected askUserToShare() {\r\n        this.setStep(Step.SHARE);\r\n    }\r\n\r\n    protected async executeProcedure() {\r\n        const { providerKey, procedureKey } = this;\r\n        if (!providerKey || !procedureKey) return;\r\n\r\n        // We pass a callback to the WalletService for asking consent to receive\r\n        const onConsent = (data: any) => {\r\n            this.askUserToReceive(data);\r\n            return new Promise<boolean>((resolve) => this.hookUserConsentToReceive.on(resolve));\r\n        }\r\n\r\n        try {\r\n            const result = await this.walletService.requestOWAttestSharingApproved(\r\n                providerKey, procedureKey, onConsent);\r\n\r\n\r\n            if (result) {\r\n                result.forEach(a => this.attributeService.storeAttribute(a));\r\n                this.showMessage('The attributes were successfully added to your identity.');\r\n                this.setStatus(Status.COMPLETE);\r\n                this.done();\r\n                return result;\r\n            } else {\r\n                this.showMessage('The attributes were not added to your identity.');\r\n                this.setStatus(Status.ABORTED);\r\n                this.done();\r\n                return [];\r\n            }\r\n\r\n        } catch (e) {\r\n            this.showMessage(\"Something went wrong\");\r\n            console.error(\"Something went wrong\", e);\r\n            this.setStatus(Status.FAILED);\r\n        }\r\n    }\r\n\r\n    protected askUserToReceive(data: any) {\r\n        console.log(\"Asking user\", data);\r\n        this.receiveRequest = {\r\n            attributes: data,\r\n            done: () => { },\r\n            id: \"\",\r\n            provider: this.provider?.mid_b64!,\r\n            reason: \"You asked for them\"\r\n        }\r\n        this.setStep(Step.RECEIVE);\r\n    }\r\n\r\n    protected saveReceivedCredentials() {\r\n        // Done in executeProcedure\r\n    }\r\n\r\n    protected done() {\r\n        this.setStep(Step.DONE);\r\n    }\r\n\r\n    protected abortProcedure() {\r\n        this.setStatus(Status.ABORTED);\r\n        this.setStep(Step.DONE);\r\n    }\r\n\r\n    protected showMessage(msg: string) {\r\n        this.message = msg;\r\n    }\r\n\r\n    protected setStep(step: Step) {\r\n        this.step = step;\r\n        this.hookStep.fire(step);\r\n    }\r\n\r\n    protected setStatus(status: Status) {\r\n        this.status = status;\r\n        this.hookStatus.fire(status);\r\n    }\r\n\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Button } from \"../components/Button\";\r\nimport { CredentialCard } from \"../components/CredentialCard\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { useSelector } from \"../hooks/useSelector\";\r\nimport { getAttributes, getProviderByMid } from \"../services/local/selectors\";\r\nimport { AttributeShareRequest } from \"../types/types\";\r\n\r\nexport const ShareRequestPage: React.FC<Props> = ({ shareRequest, onSubmitConsent }) => {\r\n    const { fromLanguageDict } = useInternationalization();\r\n\r\n    const provider = useSelector(getProviderByMid(shareRequest.receiver));\r\n    const allAttributes = useSelector(getAttributes);\r\n    const attributesToShare = shareRequest.attributeNames.map(name => allAttributes.find(a => a.name === name)).filter(a => !!a);\r\n\r\n\r\n    const [pending, setPending] = useState(false);\r\n\r\n    const handleSubmit = (consent: boolean) => {\r\n        setPending(true);\r\n        onSubmitConsent(consent);\r\n    }\r\n\r\n    return !provider ? <div>...ShareRequestPage No Provider...</div> : (\r\n        <div className=\"subpage nav-compact\">\r\n            <SubpageHeader\r\n                pageTitle={\"Request Credential\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main className=\"text-center\">\r\n                <h1>Step 1: Share Information</h1>\r\n                <p>{fromLanguageDict(provider.title)} requires the following information:</p>\r\n\r\n                {attributesToShare.map(attribute => !attribute ? \"\" :\r\n                    <CredentialCard\r\n                        key={attribute.hash}\r\n                        title={fromLanguageDict(attribute.title)}\r\n                        issuerName={fromLanguageDict(attribute.provider.title)}\r\n                        imageUrl={attribute.provider.logo_url}\r\n                        value={attribute.value}\r\n                        showDetails\r\n                    />\r\n                )}\r\n\r\n\r\n                <p>Do you wish to share these credentials?</p>\r\n                <Button onClick={() => handleSubmit(true)} isPending={pending} primary >Share these credentials</Button>\r\n                <Button onClick={() => handleSubmit(false)} disabled={pending} >Do not share</Button>\r\n            </main>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    shareRequest: AttributeShareRequest,\r\n    onSubmitConsent: (consent: boolean) => any\r\n}\r\n","\r\ntype Listener<T> = (arg: T) => any;\r\ntype Unsubscribe = () => void;\r\n\r\nexport class Hook<T> {\r\n    private listeners: Array<Listener<T>> = [];\r\n\r\n    public fire(arg: T): void {\r\n        this.listeners.forEach((l) => l(arg));\r\n    }\r\n\r\n    public on(listener: Listener<T>): Unsubscribe {\r\n        this.listeners.push(listener);\r\n        return () => this.unsubscribe(listener);\r\n    }\r\n\r\n    /** Pipe the data to another hook */\r\n    public pipe(hook: Hook<T>): Unsubscribe {\r\n        const listener = (arg: T) => hook.fire(arg);\r\n        return this.on(listener);\r\n    }\r\n\r\n    private unsubscribe(listener: Listener<T>): void {\r\n        this.listeners = this.listeners.filter((l) => l !== listener);\r\n    }\r\n}\r\n","import { Recipe } from \"@tsow/ow-ssi\";\r\nimport Axios from \"axios\";\r\nimport { Dict } from '../types/Dict';\r\nimport { timer } from '../util/timer';\r\nimport { LocalState } from \"./local/LocalState\";\r\n\r\nexport enum OnlineStatus {\r\n    ONLINE, PENDING, OFFLINE\r\n}\r\n\r\n/**\r\n * The ProvidersService keeps track of known providers,\r\n * checks them for updates and allows us to add new ones\r\n * by providing a URL.\r\n */\r\nexport class ProviderService {\r\n\r\n    private online: Dict<OnlineStatus> = {};\r\n\r\n    constructor(\r\n        private state: LocalState) { }\r\n\r\n    get providers() {\r\n        return this.state.providers;\r\n    }\r\n\r\n    public checkIsOnline(id: string) {\r\n        if (!(id in this.online)) {\r\n            this.pingForOnline(id);\r\n            return false;\r\n        }\r\n        return this.online[id] === OnlineStatus.ONLINE;\r\n    }\r\n\r\n    public pingForOnline(id: string) {\r\n        this.online[id] = OnlineStatus.PENDING;\r\n        return Promise.race([\r\n            this.getByURL(this.state.providers[id].url).then(() => true).catch(() => false),\r\n            timer(1000).then(() => false),\r\n        ]).then(isOnline => {\r\n            this.online[id] = isOnline ? OnlineStatus.ONLINE : OnlineStatus.OFFLINE;\r\n        });\r\n    }\r\n\r\n    public getByURL(url: string) {\r\n        return Axios.get(url).then(r => r.data);\r\n    }\r\n\r\n    public addByURL(url: string) {\r\n        return this.getByURL(url)\r\n            .then((details) => { this.addOrUpdate(details); return details; });\r\n    }\r\n\r\n    protected addOrUpdate(details: Recipe.RecipeServiceDescriptor) {\r\n        const s = this.state;\r\n        return this.state.store({\r\n            providers: {\r\n                ...s.providers,\r\n                [details.id]: details,\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n","import { LocalAttribute } from \"../types/State\";\r\nimport { LocalState } from \"./local/LocalState\";\r\n\r\nexport class AttributesService {\r\n\r\n    constructor(private state: LocalState) { }\r\n\r\n    get attributes() {\r\n        return this.state.attributes;\r\n    }\r\n\r\n    public storeAttribute(attr: LocalAttribute) {\r\n        const s = this.state;\r\n        this.state.store({\r\n            attributes: [...s.attributes, attr],\r\n        });\r\n    }\r\n\r\n}\r\n","import { AxiosInstance } from \"axios\";\r\nimport { IState } from \"../../types/State\";\r\n\r\n/**\r\n * Gateway to talk to the localhost\r\n */\r\nexport class LocalAPI {\r\n\r\n    constructor(private axios: AxiosInstance) { }\r\n\r\n    getState(): Promise<IState> {\r\n        return this.axios.get(\"/state\").then((d) => d.data)\r\n        // return Promise.resolve(JSON.parse(localStorage.getItem(\"state\") || \"{}\"));\r\n    }\r\n\r\n    putState(state: IState) {\r\n        return this.axios.put(\"/state\", state)\r\n        // return Promise.resolve(localStorage.setItem(\"state\", JSON.stringify(state)));\r\n    }\r\n\r\n}\r\n","import { IState } from \"../../types/State\";\r\nimport { Hook } from \"../../util/Hook\";\r\nimport { LocalAPI } from \"./LocalAPI\";\r\n\r\n/**\r\n * The LocalState is simply stored in a JSON file by the\r\n * OpenWallet Python service running on localhost. This\r\n * differs from the state stored by the IPv8 service.\r\n * \r\n * This class keeps a copy in memory and synchronises with\r\n * the python service.\r\n */\r\nexport class LocalState {\r\n\r\n    public stateChangeHook: Hook<IState> = new Hook();\r\n\r\n    private defaultState: IState = {\r\n        attributes: [],\r\n        providers: {},\r\n    };\r\n\r\n    private _state: IState = this.defaultState;\r\n\r\n    get state() {\r\n        return this._state;\r\n    }\r\n\r\n    get attributes() {\r\n        return this._state.attributes;\r\n    }\r\n\r\n    get providers() {\r\n        return this._state.providers;\r\n    }\r\n\r\n    constructor(private localApi: LocalAPI) {\r\n\r\n        this.fetch();\r\n    }\r\n\r\n    fetch() {\r\n        return this.localApi.getState()\r\n            .then(response => {\r\n                if (!response) {\r\n                    console.log(\"Local state is empty, creating default\");\r\n                    this.store(this.defaultState);\r\n                } else {\r\n                    this.updateState(response)\r\n                }\r\n            });\r\n    }\r\n\r\n    store(state: Partial<IState>) {\r\n        this.updateState(state);\r\n        return this.localApi.putState(this.state);\r\n    }\r\n\r\n    protected updateState(newState: Partial<IState>) {\r\n        this._state = { ...this.state, ...newState };\r\n        console.log(\"UPDATED LOCAL STATE\", this._state);\r\n        this.stateChangeHook.fire(this.state);\r\n    }\r\n\r\n}\r\n","import { IPv8, OpenWallet, Recipe } from \"@tsow/ow-ssi\";\r\nimport Axios from \"axios\";\r\nimport { Dict } from \"../types/Dict\";\r\nimport { LocalAttribute } from \"../types/State\";\r\nimport { LocalState } from \"./local/LocalState\";\r\nimport { ProviderService } from './ProviderService';\r\n\r\nexport class OpenWalletService {\r\n\r\n    constructor(\r\n        private providersService: ProviderService,\r\n        private localState: LocalState,\r\n        private ipv8: IPv8.IPv8Service,\r\n        private recipeClient: Recipe.RecipeClient) {\r\n\r\n    }\r\n\r\n    /**\r\n     * The Agent will request attributes according to a Procedure specified\r\n     * by a Provider. The End User has approved sharing of the required data\r\n     * if any. \r\n     * \r\n     * @param providerId \r\n     * @param procedureId \r\n     * @param onConsentStore \r\n     */\r\n    async requestOWAttestSharingApproved(\r\n        providerId: string,\r\n        procedureId: string,\r\n        onConsentStore: (data: OfferedAttribute[]) => Promise<boolean>\r\n    ): Promise<LocalAttribute[]> {\r\n\r\n        const provider = this.providersService.providers[providerId];\r\n        const recipe = provider.recipes[procedureId];\r\n        const requirements = (recipe.verify_request?.attributes || []).map(a => a.name);\r\n\r\n        // Resolution TODO update\r\n        const dataToShare: Dict<string> = this.localState.attributes\r\n            .filter((a) => requirements.indexOf(a.name) >= 0)\r\n            .reduce((c, a) => ({ ...c, [a.name]: a.value }), {});\r\n\r\n        let vResp: OpenWallet.OWVerifyResponse;\r\n\r\n        const process = this.recipeClient.createProcess(recipe);\r\n\r\n        const myAtts = await this.ipv8.api.listAttestations();\r\n\r\n        if (recipe.verify_request) {\r\n            vResp = {\r\n                attributes: recipe.verify_request?.attributes.map((a, i) => ({\r\n                    hash: myAtts.find(x => x.attribute_name === a.name)?.attribute_hash || \"\",\r\n                    ref: a.name,\r\n                    value: dataToShare[a.name],\r\n                })),\r\n                request_hash: \"\",\r\n                // @ts-ignore\r\n                subject_id: this.recipeClient.myId, // FIXME\r\n            }\r\n            process.allowVerification(vResp);\r\n        }\r\n\r\n        const recipeRequest = process.createRequest(vResp!);\r\n\r\n        const httpResponse = await Axios.post(recipe.service_endpoint, { request: recipeRequest });\r\n        const offer: OpenWallet.OWAttestOffer = httpResponse.data.offer;\r\n\r\n        const data = offer.attributes.map(a => ({\r\n            name: a.name,\r\n            value: a.value,\r\n            title: recipe.attributes.find(x => x.name === a.name)?.title || {},\r\n            signer_mid_b64: offer.attester_id,\r\n        }))\r\n\r\n        if (!process.validateOffer(offer)) {\r\n            console.warn(\"Server offer did not pass validation\");\r\n            return [];\r\n        }\r\n\r\n        const consent = await onConsentStore(data);\r\n\r\n        if (!consent) {\r\n            return [];\r\n        }\r\n\r\n        const attributes = await process.requestAttestation(offer);\r\n\r\n        console.log('Received result', attributes);\r\n\r\n        if (!attributes) {\r\n            return [];\r\n        }\r\n\r\n        return attributes.map((attr): LocalAttribute => {\r\n            const attrDesc = recipe.attributes.find((a: any) => a.name === attr.name);\r\n\r\n            if (attr && attrDesc) {\r\n                return {\r\n                    name: attr.name,\r\n                    value: attr.value,\r\n                    hash: attr.hash,\r\n                    time: Date.now(), // FIXME should come from client\r\n                    provider_title: provider.title,\r\n                    title: attrDesc.title,\r\n                    type: attrDesc.format,\r\n                    metadata: attr.metadata,\r\n                    signer_mid_b64: attr.signer_mid_b64,\r\n                };\r\n            } else {\r\n                throw new Error(\"Attestation or procedure not found\"); // FIXME\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport interface OfferedAttribute {\r\n    name: string;\r\n    value: string;\r\n    title: Dict<string>;\r\n    signer_mid_b64: string;\r\n}\r\n","\r\nexport function timer(timeInMillis: number) {\r\n    return new Promise((resolve) => setTimeout(resolve, timeInMillis));\r\n}\r\n","import { Hook } from \"./Hook\";\r\n\r\nexport class Interval {\r\n\r\n    private hook: Hook<number> = new Hook();\r\n    private index = 0;\r\n    private intervalHandle: any = null;\r\n\r\n    listen(handler: (index: number) => any) {\r\n        this.hook.on(handler);\r\n    }\r\n\r\n    start(ms: number) {\r\n        this.intervalHandle = setInterval(() => this.hook.fire(this.index++), ms);\r\n    }\r\n\r\n    stop() {\r\n        clearInterval(this.intervalHandle);\r\n    }\r\n}\r\n","/**\r\n * Communication between Wallets may occur through QR encoded messages. As the \r\n * space of QR is limited, we'll employ a callback-like system.\r\n * \r\n * 1. Our agent registers a callback function and receives a reference in turn.\r\n * 2. Via QR (or another channel) our agent sends its `member id` and the reference.\r\n * 3. The receiving agent calls our callback-resolver endpoint with the reference.\r\n * 4. Our resolver then invokes the registered callback with the id of the other agent.\r\n * \r\n * We want to limit the availability of these callbacks, so they expire after a\r\n * certain time. However, due to the round trip latency, we need a delay between\r\n * updating our reference and deprecating it. In other words, we need two or more\r\n * references to resolve to the same callback.\r\n */\r\nimport uuid from \"uuid/v4\";\r\nimport { Hook } from \"../util/Hook\";\r\nimport { Interval } from \"../util/Interval\";\r\n\r\n/**\r\n * A pointer to some value maintained by a Reference Service\r\n */\r\nexport interface Reference { id: string; }\r\n\r\n/**\r\n * With a Reference Service we can 'register' certain values and obtain a \r\n * ReferenceHandle for that value. The ReferenceHandle then generates new\r\n * References at a given interval, which expire after a given time. \r\n * \r\n * The Service then allows us to resolve a Reference to the registered value,\r\n * so long as it is not expired.\r\n * \r\n * We use this, for example, for communicating references to callbacks with\r\n * other Peers via QR or other one-way channels. As the other Peer calls us\r\n * with such a reference, this service may resolve that to the original \r\n * callback function that was registered with it, and execute the corresponding\r\n * logic.\r\n */\r\nexport interface IReferenceService<T> {\r\n\r\n    /** Register a value, receiving an idle Reference Handle */\r\n    register(value: T, options?: Partial<ReferenceOptions>): IReferenceHandle<T>\r\n\r\n    /** Resolve a Reference to a value, if it is still valid */\r\n    resolveReference(ref: Reference): IReferenceHandle<T> | undefined\r\n}\r\n\r\n/**\r\n * The Reference Handle contains the pointer to the registered value and \r\n * allows us to control and subscribe to its Reference-generation behaviour.\r\n */\r\nexport interface IReferenceHandle<T> {\r\n\r\n    /** The registered value */\r\n    value: T\r\n\r\n    /** The references that are currently alive */\r\n    references: Reference[]\r\n\r\n    /** Subscribe to the event of a new Reference being generated */\r\n    onNewReference(handler: (ref: Reference) => any): void\r\n\r\n    /** Subscribe to the event of a Reference expiring (or otherwise invalidating) */\r\n    onInvalidate(handler: (ref: Reference) => any): void\r\n\r\n    /** Subscribe to the event of this handle being destroyed */\r\n    onDestroy(handler: () => any): void\r\n\r\n    /** Start generating new References */\r\n    refreshAtInterval(millis: number): void\r\n\r\n    /** Stop generating new References */\r\n    stopRefreshing(): void\r\n\r\n    /** Invalidates all References and stops refreshing */\r\n    destroy(): void\r\n\r\n}\r\n\r\nexport class ReferenceService<T> implements IReferenceService<T> {\r\n\r\n    private handles: IReferenceHandle<T>[] = [];\r\n\r\n    constructor(private options: ReferenceOptions) { }\r\n\r\n    register(value: T, options: Partial<ReferenceOptions> = {}): IReferenceHandle<T> {\r\n        const handle = new ReferenceHandle(value, { ...this.options, ...options });\r\n        this.handles.push(handle);\r\n        handle.onDestroy(() => this.removeHandle(handle));\r\n        return handle;\r\n    }\r\n\r\n    resolveReference(ref: Reference) {\r\n        return this.handles.find(h => h.references.find(r => r.id === ref.id));\r\n    }\r\n\r\n    protected removeHandle(handle: IReferenceHandle<T>) {\r\n        this.handles = this.handles.filter(h => h !== handle);\r\n    }\r\n\r\n}\r\n\r\nclass ReferenceHandle<T> implements IReferenceHandle<T> {\r\n\r\n    public references: Reference[] = [];\r\n\r\n    private freshRefHook: Hook<Reference> = new Hook();\r\n    private invalidationHook: Hook<Reference> = new Hook();\r\n    private destroyHook: Hook<void> = new Hook();\r\n\r\n    private interval: Interval = new Interval();\r\n\r\n    constructor(\r\n        readonly value: T,\r\n        private options: ReferenceOptions,\r\n    ) {\r\n        this.interval.listen(() => this.createNewReference());\r\n    }\r\n\r\n    onNewReference(handler: (ref: Reference) => any) {\r\n        return this.freshRefHook.on(handler);\r\n    }\r\n\r\n    onInvalidate(handler: (ref: Reference) => any) {\r\n        return this.invalidationHook.on(handler);\r\n    }\r\n\r\n    onDestroy(handler: () => any) {\r\n        return this.destroyHook.on(handler);\r\n    }\r\n\r\n    refreshAtInterval(millis: number) {\r\n        this.createNewReference();\r\n        this.interval.start(millis);\r\n    }\r\n\r\n    stopRefreshing() {\r\n        this.interval.stop();\r\n    }\r\n\r\n    destroy() {\r\n        this.stopRefreshing();\r\n        this.references.forEach(r => this.expireReference(r));\r\n\r\n        this.destroyHook.fire();\r\n    }\r\n\r\n    protected createNewReference() {\r\n        const ref = { id: uuid() };\r\n\r\n        this.references.push(ref);\r\n\r\n        setTimeout(() => this.expireReference(ref), this.options.millisToExpire);\r\n\r\n        this.freshRefHook.fire(ref);\r\n    }\r\n\r\n    protected expireReference(ref: Reference) {\r\n        if (this.references.find(r => r === ref)) {\r\n            this.references = this.references.filter(r => r !== ref);\r\n\r\n            this.invalidationHook.fire(ref);\r\n\r\n            if (this.options.destroyWhenNoReferences && this.references.length === 0) {\r\n                this.destroy();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport interface ReferenceOptions {\r\n    millisToExpire: number;\r\n    destroyWhenNoReferences: boolean;\r\n}\r\n","import { IPv8, OpenWallet, Recipe } from \"@tsow/ow-ssi\";\r\nimport axios from \"axios\";\r\nimport Cookies from \"universal-cookie\";\r\nimport { ServiceList } from \"../hooks/useServices\";\r\nimport { Dict } from \"../types/Dict\";\r\nimport { AttributeShareRequest } from \"../types/types\";\r\nimport { AttributesService } from \"./AttributeService\";\r\nimport { LocalAPI } from \"./local/LocalAPI\";\r\nimport { LocalState } from \"./local/LocalState\";\r\nimport { OpenWalletService } from \"./OpenWalletService\";\r\nimport { ProviderService } from \"./ProviderService\";\r\nimport { ReferenceService } from \"./ReferenceService\";\r\n\r\n\r\nconst portFromUrl = window.location.hash.match(/port=([0-9]+)/);\r\n\r\nconst cookie = new Cookies();\r\nconst port = (portFromUrl ? portFromUrl[1] : null) || cookie.get(\"port\") || \"8124\";\r\ncookie.set(\"port\", port);\r\n\r\nexport const localhostBase = `http://localhost:${port}`;\r\n\r\nconst localhost = axios.create({\r\n    baseURL: localhostBase,\r\n});\r\n\r\nexport const localAPI = new LocalAPI(localhost);\r\nexport const localState = new LocalState(localAPI);\r\n\r\nexport const attributeService = new AttributesService(localState);\r\n\r\nexport const ipv8Service = new IPv8.IPv8Service(localhostBase, 1000);\r\nipv8Service.start();\r\n\r\nexport const callbackService = new ReferenceService<PeerCallback>({ destroyWhenNoReferences: true, millisToExpire: 20000 });\r\nexport type PeerCallback = (memberId: string) => any;\r\n\r\n// @ts-ignore\r\nwindow.peercalls = (memberId: string, refId: string) => {\r\n    const handle = callbackService.resolveReference({ id: refId });\r\n    if (handle) {\r\n        console.log(`Peer '${memberId}' called. Handle found!`);\r\n        handle.value(memberId);\r\n    } else {\r\n        console.log(`Peer '${memberId}' called. Could not find handle..`);\r\n    }\r\n}\r\n\r\nexport let providersService: ProviderService | null = null;\r\nexport let owService: OpenWalletService | null = null;\r\n\r\nexport const initServices = () => ipv8Service.api.getMyId().then((mid): ServiceList => {\r\n    console.log(\"TCL: mid\", mid)\r\n\r\n    providersService = new ProviderService(localState);\r\n    const owVerifiee = new OpenWallet.OWVerifiee(ipv8Service.verifieeService);\r\n    const owAttestee = new OpenWallet.OWAttestee(ipv8Service.attesteeService);\r\n    const recipeClient = new Recipe.RecipeClient(mid, owVerifiee, owAttestee);\r\n    owService = new OpenWalletService(\r\n        providersService,\r\n        localState,\r\n        ipv8Service,\r\n        recipeClient,\r\n    );\r\n\r\n    return {\r\n        localAPI,\r\n        localState,\r\n        ipv8Service,\r\n        attributeService,\r\n        callbackService,\r\n        providersService,\r\n        owService,\r\n    }\r\n});\r\n\r\nexport const reqs: Dict<AttributeShareRequest> = {};\r\n","import React, { useEffect, useState } from 'react';\r\nimport { CredentialCreatePage } from \"../pages/CredentialCreatePage\";\r\nimport { ProcedureDonePage } from \"../pages/ProcedureDonePage\";\r\nimport { ReceiveAttributesPage } from \"../pages/ReceiveAttributesPage\";\r\nimport { ShareRequestPage } from \"../pages/ShareRequestPage\";\r\nimport { RequestProcedureFlowRunner, Status } from \"../services/RequestProcedureFlowRunner\";\r\nimport { attributeService, owService, providersService } from \"../services/services\";\r\n\r\nenum Step { INIT, SHARE, RECEIVE, DONE };\r\n\r\nlet flow: RequestProcedureFlowRunner;\r\nexport const CredentialCreateFlow: React.FC = () => {\r\n\r\n    const [step, setStep] = useState<Step>(Step.INIT);\r\n\r\n    useEffect(() => {\r\n        setTimeout(() => {\r\n            flow = new RequestProcedureFlowRunner(providersService!, owService!, attributeService);\r\n            flow.hookStep.on(step => { console.log(step); setStep(step) });\r\n\r\n        }, 2000);\r\n    }, [])\r\n\r\n    switch (step) {\r\n        case Step.INIT: return <CredentialCreatePage onSubmitRequest={(pv, pc) => flow.userStartsRequest(pv, pc)} />;\r\n        case Step.SHARE: return <ShareRequestPage shareRequest={flow.shareRequest!} onSubmitConsent={(consent) => flow.userConsentsToShare(consent)} />\r\n        case Step.RECEIVE: return <ReceiveAttributesPage receiveRequest={flow.receiveRequest!} onSubmitConsent={(consent) => flow.userConsentsToReceive(consent)} />\r\n        case Step.DONE: return <ProcedureDonePage messageBody={flow.message} messageTitle={flow.status === Status.COMPLETE ? \"Success\" : \"No success\"} pageTitle={\"Create\"} />\r\n        default: return <div>This should not happen</div>;\r\n    }\r\n}\r\n\r\n","import { IPv8 } from \"@tsow/ow-ssi\";\r\nimport { Hook } from \"../util/Hook\";\r\nimport { OpenWalletService } from \"./OpenWalletService\";\r\nimport { VerificationOffer } from \"./QRService\";\r\n\r\nexport enum Step { INIT, CONFIRM, DONE };\r\nexport enum Status { PENDING, COMPLETE, ABORTED, FAILED };\r\n\r\nexport class CredentialVerifyFlowRunner {\r\n    public step: Step = Step.INIT;\r\n    public status: Status = Status.PENDING;\r\n    public hookStep: Hook<Step> = new Hook();\r\n    // public hookUserConsentToVerify: Hook<boolean> = new Hook();\r\n    public hookStatus: Hook<Status> = new Hook();\r\n    public offer: VerificationOffer | undefined;\r\n\r\n    public message: string = \"\";\r\n\r\n    constructor(\r\n        private walletService: OpenWalletService,\r\n        private verifierService: IPv8.VerifierService,\r\n    ) { }\r\n\r\n    userStartsRequest(verifyOffer: VerificationOffer) {\r\n        this.offer = verifyOffer;\r\n        this.setStep(Step.CONFIRM);\r\n    }\r\n\r\n    userConsentsToVerify(consent: boolean) {\r\n        if (consent) {\r\n            this.executeProcedure();\r\n        } else {\r\n            this.abortProcedure();\r\n        }\r\n    }\r\n\r\n    protected async executeProcedure() {\r\n        // setTimeout(() => this.showVerificationResult(), 1000);\r\n        this.verifierService.verify(\r\n            this.offer!.mid,\r\n            [{\r\n                attribute_hash: this.offer!.attribute_hash,\r\n                attribute_value: this.offer!.attribute_value,\r\n                attribute_name: this.offer!.attribute_name,\r\n            }],\r\n            // { maxAgeInSeconds: 3600 * 24 * 365 }\r\n        ).then((result) => {\r\n            this.showVerificationResult(result);\r\n        })\r\n    }\r\n\r\n    protected showVerificationResult(result: boolean) {\r\n        this.showMessage(\"The result was: \" + (result ? \"verified!\" : \"unverified..\"));\r\n        this.done();\r\n    }\r\n\r\n    protected done() {\r\n        this.setStep(Step.DONE);\r\n    }\r\n\r\n    protected abortProcedure() {\r\n        this.showMessage(\"We have not verified the credential.\");\r\n        this.setStatus(Status.ABORTED);\r\n        this.setStep(Step.DONE);\r\n    }\r\n\r\n    protected showMessage(msg: string) {\r\n        this.message = msg;\r\n    }\r\n\r\n    protected setStep(step: Step) {\r\n        this.step = step;\r\n        this.hookStep.fire(step);\r\n    }\r\n\r\n    protected setStatus(status: Status) {\r\n        this.status = status;\r\n        this.hookStatus.fire(status);\r\n    }\r\n\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Button } from \"../components/Button\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { VerificationOffer } from \"../services/QRService\";\r\n\r\nexport const VerifierConsentPage: React.FC<Props> = ({ verificationOffer, onSubmitConsent }) => {\r\n    const [pending, setPending] = useState(false);\r\n\r\n    const handleSubmit = (consent: boolean) => {\r\n        setPending(true);\r\n        onSubmitConsent(consent);\r\n    }\r\n\r\n    return (\r\n        <div className=\"subpage nav-compact\">\r\n            <SubpageHeader\r\n                pageTitle={\"Verify a Credential\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main className=\"text-center\">\r\n                <h1>Verifying by QR</h1>\r\n                <p>Do you wish to verify the following?</p>\r\n\r\n                <table>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>Member ID</td>\r\n                            <td>{verificationOffer.mid}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Attribute Name</td>\r\n                            <td>{verificationOffer.attribute_name}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Attribute Hash</td>\r\n                            <td>{verificationOffer.attribute_hash}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Attribute Value</td>\r\n                            <td>{verificationOffer.attribute_value}</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n\r\n                <Button onClick={() => handleSubmit(true)} isPending={pending} primary >Verify</Button>\r\n                <Button onClick={() => handleSubmit(false)} disabled={pending} >Cancel</Button>\r\n            </main>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    verificationOffer: VerificationOffer,\r\n    onSubmitConsent: (consent: boolean) => any\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useServices } from \"../hooks/useServices\";\r\nimport { ProcedureDonePage } from \"../pages/ProcedureDonePage\";\r\nimport { VerifierConsentPage } from \"../pages/VerifierConsentPage\";\r\nimport { CredentialVerifyFlowRunner } from \"../services/CredentialVerifyFlowRunner\";\r\nimport { VerificationOffer } from \"../services/QRService\";\r\n\r\nenum Step { INIT, CONFIRM, DONE };\r\n\r\nlet flow: CredentialVerifyFlowRunner;\r\nexport const CredentialVerifyFlow: React.FC<Props> = ({ verifyOffer }) => {\r\n\r\n    const [step, setStep] = useState<Step>(Step.INIT);\r\n    const { services } = useServices();\r\n\r\n    useEffect(() => {\r\n        flow = new CredentialVerifyFlowRunner(services!.owService, services!.ipv8Service.verifierService);\r\n        flow.hookStep.on(step => { console.log(step); setStep(step) });\r\n        flow.userStartsRequest(verifyOffer)\r\n    }, []);\r\n\r\n    const handleConfirm = (consent: boolean) => flow.userConsentsToVerify(consent);\r\n\r\n    switch (step) {\r\n        case Step.INIT: return <div></div>;\r\n        case Step.CONFIRM: return <VerifierConsentPage onSubmitConsent={handleConfirm} verificationOffer={flow.offer!} />;\r\n        case Step.DONE: return <ProcedureDonePage pageTitle={\"Verify a Credential\"} messageTitle={\"Verification Result\"} messageBody={flow.message} />;\r\n        default: return <div>This should not happen</div>;\r\n    }\r\n\r\n}\r\n\r\nexport interface Props {\r\n    verifyOffer: VerificationOffer;\r\n}\r\n\r\n","\r\n/** Decodes from the In-type to the Out-type */\r\nexport interface Decodes<In, Out, Err> {\r\n    decode(obj: In): DecodeResult<Out, Err>;\r\n}\r\n\r\n/** Encodes from the In-type to the Out-type */\r\nexport interface Encodes<In, Out> {\r\n    encode(obj: In): Out;\r\n}\r\n\r\n/** Informative decoding result */\r\nexport type DecodeResult<T, Err> = SuccessfulDecode<T> | DecodeFailure<Err> | DecodeUnmatched\r\n\r\nexport interface SuccessfulDecode<T> {\r\n    status: DecodeStatus.Succeeded,\r\n    result: T\r\n}\r\n\r\nexport interface DecodeUnmatched {\r\n    status: DecodeStatus.Unmatched,\r\n}\r\n\r\nexport interface DecodeFailure<Err> {\r\n    status: DecodeStatus.Failed,\r\n    error: Err,\r\n}\r\n\r\nexport enum DecodeStatus {\r\n    Succeeded = \"Succeeded\",\r\n    Failed = \"Failed\",\r\n    Unmatched = \"Unmatched\",\r\n}\r\n\r\n/**\r\n * A MultiDecoder simply finds the first decoder that can decode\r\n * the incoming object, similar to the \"Chain of Responsibility\"\r\n * design pattern.\r\n */\r\nexport class MultiDecoder<In, Out, Err> implements Decodes<In, Out, Err> {\r\n    constructor(private decoders: Decodes<In, Out, Err>[]) { }\r\n\r\n    /**\r\n     * Finds the first codec that is able to decode the QR,\r\n     * and return the decoded result\r\n     */\r\n    decode(obj: In): DecodeResult<Out, Err> {\r\n        for (let codec of this.decoders) {\r\n            const result = codec.decode(obj);\r\n            if (result.status === DecodeStatus.Succeeded) {\r\n                return result;\r\n            } else if (result.status === DecodeStatus.Failed) {\r\n                return result;\r\n            }\r\n        }\r\n        return { status: DecodeStatus.Unmatched }\r\n    }\r\n}\r\n\r\n/**\r\n * Chain two decoders (A-to-B + B-to-C) together, creating a\r\n * single decoder A-to-C.\r\n */\r\nexport class DecoderChain<A, B, C, Err> implements Decodes<A, C, Err> {\r\n\r\n    constructor(\r\n        private decodeA: Decodes<A, B, Err>,\r\n        private decodeB: Decodes<B, C, Err>) { }\r\n\r\n    decode(a: A): DecodeResult<C, Err> {\r\n        const result = this.decodeA.decode(a);\r\n\r\n        if (result.status === DecodeStatus.Succeeded) {\r\n            return this.decodeB.decode(result.result);\r\n        } else {\r\n            return result;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { Button } from \"../components/Button\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\n\r\nexport class ConfirmContactPage extends React.Component<{}, State> {\r\n\r\n    render() {\r\n        const request: any = { provider: { title: {}, description: {} } };\r\n        const lang = \"\";\r\n        const loading = false;\r\n\r\n        return (\r\n            <div className=\"subpage nav-compact\">\r\n\r\n                <SubpageHeader\r\n                    pageTitle={\"Add Contact (QR)\"}\r\n                    backUrl={\"/contacts\"}\r\n                />\r\n\r\n                <main>\r\n                    <p>Do you trust the following organization?</p>\r\n\r\n                    <img src=\"{ request.provider.logo_url }\" style={{ width: \"20% \" }} alt=\"\" />\r\n                    <h1>{request.provider.title[lang]}</h1>\r\n                    <p>{request.provider.description[lang]}</p>\r\n                    <table>\r\n                        <tr>\r\n                            <th>ID</th>\r\n                            <td>{request.provider.mid_b64}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>Website</th>\r\n                            <td>{request.provider.website}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>Attestation Server URL</th>\r\n                            <td>{request.provider.url}</td>\r\n                        </tr>\r\n                    </table>\r\n\r\n                    <Button primary onClick={() => this.confirmRequest()} disabled={loading}>Trust and add to contacts</Button>\r\n                    <Button onClick={() => this.denyRequest()} disabled={loading}>Cancel</Button>\r\n\r\n\r\n                </main>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n    confirmRequest() {\r\n\r\n    }\r\n\r\n    denyRequest() {\r\n\r\n    }\r\n}\r\n\r\ninterface State {\r\n\r\n}","import React from 'react';\r\nimport { CredentialCard } from \"../components/CredentialCard\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\n\r\nexport class ConfirmIncomingVerificationPage extends React.Component<{}, State> {\r\n\r\n    render() {\r\n        const request: any = { provider: { title: {}, description: {} } };\r\n        const loading = false;\r\n\r\n        return (\r\n            <div className=\"subpage nav-compact\">\r\n                <SubpageHeader\r\n                    pageTitle={\"Verification Request\"}\r\n                    backUrl={\"/\"}\r\n                />\r\n\r\n                <main className=\"text-center\" >\r\n                    <h1>Someone wishes to verify</h1>\r\n                    <p>\r\n                        {request.mid} wishes to verify your information:\r\n                </p>\r\n                    <CredentialCard\r\n                        title={\"Age\"}\r\n                        issuerName={\"Staat der Nederlanden\"}\r\n                        imageUrl={\"\"}\r\n                        value={\"28\"}\r\n                        showDetails={true}\r\n                    />\r\n\r\n                    <p>Do you wish to share these credentials?</p>\r\n                    <button className=\"btn primary\" onClick={() => this.confirmRequest()} disabled={loading}>Share and continue</button>\r\n                    <button className=\"btn secondary\" onClick={() => this.denyRequest()} disabled={loading}>Cancel</button>\r\n                </main>\r\n\r\n            </div>\r\n        )\r\n\r\n    }\r\n\r\n    confirmRequest() {\r\n\r\n    }\r\n\r\n    denyRequest() {\r\n\r\n    }\r\n}\r\n\r\ninterface State {\r\n\r\n}","import React from 'react';\r\nimport { CredentialCard } from \"../components/CredentialCard\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { useSelector } from \"../hooks/useSelector\";\r\nimport { getProviderByMid } from \"../services/local/selectors\";\r\n\r\nexport const ContactDetailPage: React.FC<Props> = ({ providerMid }) => {\r\n\r\n    const { fromLanguageDict } = useInternationalization();\r\n\r\n    const provider = useSelector(getProviderByMid(providerMid));\r\n\r\n    return !provider ? <div>Oops! Provider not found</div> : (\r\n\r\n        <div className=\"subpage nav-compact\">\r\n            <SubpageHeader\r\n                pageTitle={\"Contact\"}\r\n                backUrl={\"/contacts\"}\r\n            />\r\n\r\n            <main>\r\n                <img src={provider.logo_url} alt={fromLanguageDict(provider.title)} />\r\n                <h1>{fromLanguageDict(provider.title)}</h1>\r\n                <p>{fromLanguageDict(provider.description)}</p>\r\n                <table>\r\n                    <tbody>\r\n                        <tr>\r\n                            <th>ID</th>\r\n                            <td>{provider.mid_b64}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>Website</th>\r\n                            <td>{provider.website}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>Attestation Server URL</th>\r\n                            <td><a href={provider.url + \"/about\"}>{provider.url}</a></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n\r\n                <h2>Credentials</h2>\r\n                <p>{fromLanguageDict(provider.title)} offers the following credentials:</p>\r\n\r\n                {Object.values(provider.recipes).map(recipe => (\r\n                    <CredentialCard\r\n                        imageUrl={provider.logo_url}\r\n                        title={fromLanguageDict(recipe.title)}\r\n                        issuerName={fromLanguageDict(provider.title)}\r\n                        key={recipe.name}\r\n                    />\r\n                ))}\r\n            </main>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    providerMid: string;\r\n}","import React from 'react';\r\nimport { Icon } from \"./Icon\";\r\n\r\nexport const ContactCard: React.FC<Props> = (p) => (\r\n\r\n    <div className=\"card-item\">\r\n        <div className=\"row\">\r\n            <div className=\"logo-box\">\r\n                <img src={p.logoUrl} alt=\"\" />\r\n            </div>\r\n            <div className=\"text-box\">\r\n                <div className=\"primary\">{p.title}</div>\r\n            </div>\r\n            <div className=\"tool\">\r\n                <div className=\"clickable\">\r\n                    <Icon info-circle />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n);\r\n\r\n\r\ninterface Props {\r\n    logoUrl: string;\r\n    title: string;\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { Button } from \"../components/Button\";\r\nimport { ContactCard } from \"../components/ContactCard\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { useSelector } from \"../hooks/useSelector\";\r\nimport { useServices } from \"../hooks/useServices\";\r\nimport { getProviders } from \"../services/local/selectors\";\r\n\r\nexport const ContactIndexPage: React.FC = () => {\r\n\r\n    const { fromLanguageDict } = useInternationalization();\r\n    const { services } = useServices();\r\n\r\n    const providers = useSelector(getProviders);\r\n\r\n    const peopleCount = 0;\r\n\r\n    const defaultContactUrl = \"http://localhost\"\r\n    const [contactUrl, setContactUrl] = useState(defaultContactUrl);\r\n    const [pending, setPending] = useState(false);\r\n    const saveContact = (url: string) => {\r\n        setPending(true);\r\n        services!.providersService?.addByURL(url).then(() => {\r\n            setContactUrl(defaultContactUrl);\r\n        }).catch((e) => {\r\n            alert(\"Failed to add that provider\");\r\n        }).finally(() => setPending(false));\r\n    }\r\n\r\n    return (\r\n        <div className=\"subpage nav-compact\">\r\n            <SubpageHeader\r\n                pageTitle={\"Contacts\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main>\r\n                <h1>People ({peopleCount})</h1>\r\n                <small>No people yet..</small>\r\n\r\n                <h1>Organisations ({providers.length})</h1>\r\n                {providers.map(provider => (\r\n                    <Link to={`/contacts/${encodeURIComponent(provider.mid_b64)}`} key={provider.mid_b64}>\r\n                        <ContactCard\r\n                            logoUrl={provider.logo_url}\r\n                            title={fromLanguageDict(provider.title)}\r\n                        />\r\n                    </Link>\r\n                ))}\r\n\r\n                <h1>Add By URL</h1>\r\n                <form onSubmit={() => saveContact(contactUrl)}>\r\n                    <div className=\"col-xs-12\">\r\n                        <input type=\"url\" className=\"text-input\" placeholder=\"Enter the URL of the provider\"\r\n                            required value={contactUrl} onChange={(e) => setContactUrl(e.target.value)} />\r\n                        <br />\r\n                        <br />\r\n                        <Button type={\"submit\"} primary isPending={pending}>Add Contact</Button>\r\n                    </div>\r\n                </form>\r\n            </main>\r\n\r\n        </div>\r\n    )\r\n\r\n}\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Icon } from \"./Icon\";\r\n\r\nexport const BottomTools: React.FC<Props> = (p: Props) => (\r\n    <div className=\"bottom-tools\">\r\n        {!p.showQR ? \"\" :\r\n            <Link to={\"/qr\"} >\r\n                <div className=\"fab-btn primary bottom-center\" style={{ fontSize: \"3em\" }}>\r\n                    <img src={require(\"../assets/images/qr-scan.svg\")} alt=\"\" style={{ width: \"50%\" }} />\r\n                </div>\r\n            </Link>\r\n        }\r\n        {!p.showPlus ? \"\" :\r\n            <Link className=\"fab-btn secondary bottom-right\" style={{ fontSize: \"2em\" }}\r\n                to=\"/create\">\r\n                <Icon plus />\r\n            </Link>\r\n        }\r\n    </div>\r\n)\r\n\r\ninterface Props {\r\n    showQR?: boolean;\r\n    showPlus?: boolean;\r\n}\r\n","/**\r\n * This module handles the generic encoding and decoding of QR messages. \r\n * Domain specific codecs should implement these interfaces.\r\n * \r\n * Encoding and decoding QRs is done in two steps:\r\n * - All QR strings are first decoded to a QRX object\r\n * - The QRX object is subsequently decoded to a message object\r\n */\r\n\r\nimport { DecoderChain, DecodeResult, Decodes, DecodeStatus, Encodes, MultiDecoder } from \"./GenericDecoding\";\r\n\r\n/** The intermediate data object */\r\nexport class QRX<T> {\r\n    constructor(\r\n        readonly type: string,\r\n        readonly payload: T,\r\n    ) { }\r\n}\r\n\r\nexport interface QRStringDecoder extends Decodes<string, QRX<string>, QRDecodeError> { }\r\nexport interface QRStringEncoder extends Encodes<QRX<string>, string> { }\r\nexport interface QRDomainDecoder<T> extends Decodes<QRX<string>, QRX<T>, QRDecodeError> { }\r\nexport interface QRDomainEncoder<T> extends Encodes<T, QRX<string>> { }\r\n\r\nexport type QRDecodeResult<T> = DecodeResult<QRX<T>, QRDecodeError>;\r\n\r\n/** Helper for creating Successful QRDecodeResult */\r\nexport const decodeSucceded = <T>(result: QRX<T>): QRDecodeResult<T> => ({ status: DecodeStatus.Succeeded, result })\r\n/** Helper for creating Failed QRDecodeResult */\r\nexport const decodeFailed = <T>(error: QRDecodeError): QRDecodeResult<T> => ({ status: DecodeStatus.Failed, error })\r\n/** Helper for creating Unmatched QRDecodeResult */\r\nexport const decodeUnmatched = <T>(): QRDecodeResult<T> => ({ status: DecodeStatus.Unmatched })\r\n\r\nexport enum QRDecodeError {\r\n    INVALID_FORMAT = \"INVALID_FORMAT\",\r\n    INVALID_PAYLOAD = \"INVALID_PAYLOAD\",\r\n    UNMATCHED_TYPE = \"UNMATCHED_TYPE\",\r\n}\r\n\r\nexport class MultiQRDecoder<T> implements Decodes<string, QRX<T>, QRDecodeError> {\r\n\r\n    private decoder: Decodes<string, QRX<T>, QRDecodeError>\r\n\r\n    constructor(\r\n        stringDecoder: QRStringDecoder,\r\n        domainDecoders: QRDomainDecoder<T>[]) {\r\n\r\n        this.decoder = new DecoderChain(stringDecoder, new MultiDecoder(domainDecoders));\r\n    }\r\n\r\n    decode(str: string): QRDecodeResult<T> {\r\n        return this.decoder.decode(str);\r\n    }\r\n}\r\n","import { decodeFailed, decodeSucceded, decodeUnmatched, MultiQRDecoder, QRDecodeError, QRDecodeResult, QRDomainDecoder, QRDomainEncoder, QRStringDecoder, QRStringEncoder, QRX } from \"../modules/QR/QREncoding\";\r\n\r\nexport class SimpleQRStringCodec implements QRStringDecoder, QRStringEncoder {\r\n\r\n    encode(qrx: QRX<any>): string {\r\n        return qrx.type + \"|\" + qrx.payload;\r\n    }\r\n\r\n    decode(str: string): QRDecodeResult<string> {\r\n        const [type, payload] = str.split(\"|\");\r\n        if (!type || !payload) {\r\n            return decodeFailed(QRDecodeError.INVALID_FORMAT);\r\n        } else {\r\n            return decodeSucceded(new QRX(type, payload));\r\n        }\r\n    }\r\n}\r\n\r\nexport class VerificationOfferCodec implements QRDomainDecoder<VerificationOffer>, QRDomainEncoder<VerificationOffer> {\r\n    private TYPE = \"VerifyOffer\";\r\n\r\n    encode(payload: VerificationOffer): QRX<string> {\r\n        return new QRX(this.TYPE, JSON.stringify(payload));\r\n    }\r\n\r\n    decode(qrx: QRX<string>): QRDecodeResult<VerificationOffer> {\r\n        if (qrx.type !== this.TYPE) {\r\n            return decodeUnmatched();\r\n        }\r\n        try {\r\n            const d = JSON.parse(qrx.payload);\r\n            if (!d.mid || !d.attribute_hash || !d.attribute_value) {\r\n                return decodeFailed(QRDecodeError.INVALID_PAYLOAD);\r\n            } else {\r\n                return decodeSucceded(d);\r\n            }\r\n        } catch (e) {\r\n            return decodeFailed(QRDecodeError.INVALID_FORMAT);\r\n        }\r\n    }\r\n}\r\n\r\nexport interface VerificationOffer {\r\n    mid: string;\r\n    attribute_name: string;\r\n    attribute_hash: string;\r\n    attribute_value: string;\r\n}\r\n\r\nexport const qrDecoder = new MultiQRDecoder(new SimpleQRStringCodec(), [new VerificationOfferCodec()])\r\n\r\nexport function makeEncoder<T>(encoder: QRDomainEncoder<T>) {\r\n    const strEncoder = new SimpleQRStringCodec();\r\n    return (payload: T) => strEncoder.encode(encoder.encode(payload));\r\n}\r\n","import React, { useMemo, useState } from 'react';\r\nimport { BottomTools } from \"../components/BottomTools\";\r\nimport { CredentialCard } from \"../components/CredentialCard\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { useClock } from \"../hooks/useClock\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { usePromised } from \"../hooks/usePromised\";\r\nimport { useCallbackReference } from \"../hooks/useQR\";\r\nimport { useSelector } from \"../hooks/useSelector\";\r\nimport { useServices } from \"../hooks/useServices\";\r\nimport { getAttributeByHash } from \"../services/local/selectors\";\r\nimport { makeEncoder, VerificationOfferCodec } from \"../services/QRService\";\r\n\r\nconst encodeVerifOffer = makeEncoder(new VerificationOfferCodec());\r\n\r\nexport const CredentialDetailPage: React.FC<Props> = ({ id, useReferenceQR }) => {\r\n\r\n    const { services } = useServices();\r\n    const { fromLanguageDict } = useInternationalization();\r\n    const attr = useSelector(useMemo(() => getAttributeByHash(id), [id]));\r\n    const myMid = usePromised(() => services!.ipv8Service.api.getMyId().catch(e => console.error(e)));\r\n\r\n    // The user may pick either the QR from the credential or from the attribute\r\n    const [selectedQR, setSelectedQR] = useState<string>(\"\");\r\n    const toggleQR = (name: string) => setSelectedQR(selectedQR === name ? \"\" : name);\r\n\r\n    // Once a peer scans the QR and calls us with the reference, it will invoke the onPeerScan callback.\r\n    const onPeerScan = (callbackId: string) => console.log(\"Peer called to verify \" + attr?.name, callbackId)\r\n    const onPeerScanMemoized = useMemo(() => onPeerScan, [myMid, attr, selectedQR]);\r\n    const referenceForPeer = useCallbackReference(onPeerScanMemoized, { refreshIntervalMillis: 1000 });\r\n\r\n    let qrValue = (!myMid || !selectedQR) ? \"\" : myMid + \"|\" + referenceForPeer;\r\n\r\n    const time = useClock(1000);\r\n\r\n    if (!useReferenceQR && myMid) {\r\n        const expirationInSeconds = 10;\r\n        const verificationOffer = {\r\n            mid: myMid!,\r\n            attribute_hash: attr!.hash,\r\n            attribute_value: attr!.value,\r\n            attribute_name: attr!.name,\r\n            expiresAt: time + (expirationInSeconds * 1000),\r\n        }\r\n        qrValue = (!myMid || !selectedQR) ? \"\" : encodeVerifOffer(verificationOffer);\r\n    }\r\n\r\n    return (\r\n        <div className=\"subpage nav-compact main-over-nav\">\r\n\r\n            <SubpageHeader\r\n                pageTitle={\"Credential\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main>\r\n                {!attr ? \"Credential Unknown..\" : (\r\n                    <CredentialCard\r\n                        title={fromLanguageDict(attr.title)}\r\n                        issuerName={fromLanguageDict(attr.provider.title)}\r\n                        imageUrl={attr.provider.logo_url}\r\n                        withQRs\r\n                        onDisplayQR={toggleQR}\r\n                        qrValue={qrValue}\r\n                        value={attr.value}\r\n                        showDetails={true}\r\n                        showMeta={true}\r\n                        metadata={[\r\n                            { key: \"Signed by\", value: fromLanguageDict(attr.provider.title) },\r\n                            { key: \"Created at\", value: `${attr.time}` },\r\n                            { key: \"Valid until\", value: \"2020-09-01 13:20:00 CET\" },\r\n                        ]} />\r\n                )}\r\n            </main>\r\n\r\n            <BottomTools showQR />\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface Props {\r\n    id: string;\r\n    /** If set to true, will use ReferenceQRs (callback system) instead of data-QRs */\r\n    useReferenceQR?: boolean;\r\n}\r\n","import { useEffect, useState } from \"react\";\r\nimport { callbackService } from \"../services/services\";\r\n\r\n\r\nexport function useCallbackReference(callback: (callbackId: string) => any, options: Options) {\r\n\r\n    const [value, setValue] = useState<string>(\"\");\r\n\r\n    useEffect(() => {\r\n        const handle = callbackService.register(callback);\r\n\r\n        handle.onNewReference(ref => setValue(ref.id));\r\n        handle.refreshAtInterval(options.refreshIntervalMillis);\r\n\r\n        return () => options.destroyOnUnmount ? handle.destroy() : handle.stopRefreshing();\r\n    }, [callback]);\r\n\r\n    return value;\r\n}\r\n\r\ninterface Options {\r\n    refreshIntervalMillis: number;\r\n    destroyOnUnmount?: boolean;\r\n}\r\n","import { useEffect, useState } from \"react\";\r\n\r\nexport function useClock(millisPerTick: number) {\r\n    const [time, setTime] = useState(Date.now());\r\n\r\n    let interval: any = null;\r\n    useEffect(() => {\r\n        setInterval(() => setTime(Date.now()), millisPerTick);\r\n        return () => clearInterval(interval);\r\n    }, [])\r\n\r\n    return time;\r\n}\r\n","\r\nimport React from \"react\";\r\nimport { useMenu } from \"../hooks/useMenu\";\r\nimport { Icon } from \"./Icon\";\r\n\r\n\r\nexport const HomepageHeader: React.FC<Omit<Props, \"openMenu\">> = (p) => {\r\n    const { setOpen } = useMenu();\r\n\r\n    return <HomepageHeaderNo openMenu={() => setOpen(true)} {...p} />\r\n}\r\n\r\nexport const HomepageHeaderNo: React.FC<Props> = (p: Props) => (\r\n    <div>\r\n        <header>\r\n            <div className=\"content\">\r\n                <div className=\"avatar\">\r\n                    <img src=\"./assets/images/user-colored.svg\" alt=\"\" />\r\n                </div>\r\n                <div className=\"text\">\r\n                    <div className=\"primary\">Tim Speelman</div>\r\n                    <div className=\"secondary\">Self-Sovereign Identity</div>\r\n                </div>\r\n                <div className=\"burger-menu\" onClick={p.openMenu}>\r\n                    <Icon bars />\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"background\"></div>\r\n        </header>\r\n\r\n        <div className=\"after-header\"> </div>\r\n    </div>\r\n)\r\n\r\ninterface Props {\r\n    openMenu: () => any;\r\n}\r\n","import React from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { BottomTools } from \"../components/BottomTools\";\r\nimport { CredentialCard } from \"../components/CredentialCard\";\r\nimport { HomepageHeader } from \"../components/HomepageHeader\";\r\nimport { useInternationalization } from \"../hooks/useInternationalization\";\r\nimport { useSelector } from \"../hooks/useSelector\";\r\nimport { getAttributes } from \"../services/local/selectors\";\r\nimport { LocalAttr } from \"../types/types\";\r\n\r\nexport const CredentialIndexPage: React.FC = () => {\r\n\r\n    const attributes = useSelector(getAttributes);\r\n    const { fromLanguageDict } = useInternationalization();\r\n\r\n    return (\r\n        <div>\r\n            <HomepageHeader />\r\n\r\n            <main>\r\n                <h1>Credentials</h1>\r\n                {attributes.map(c =>\r\n                    <Link to={`/detail/${encodeURIComponent(c.hash)}`} key={c.hash}>\r\n                        <CredentialCard\r\n                            imageUrl={c.provider.logo_url}\r\n                            title={fromLanguageDict(c.title)}\r\n                            issuerName={fromLanguageDict(c.provider.title)}\r\n                        />\r\n                    </Link>\r\n                )}\r\n            </main>\r\n\r\n            <BottomTools showQR={true} showPlus={true} />\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\n// export class CredentialIndexPage extends React.Component<{}, State> {\r\n\r\n//     state: State = {\r\n//         attributes: []\r\n//     }\r\n\r\n//     componentDidMount() {\r\n//         this.loadAttributes();\r\n//     }\r\n\r\n//     async loadAttributes() {\r\n//         const attributes = await attributeQuery.listAttributes();\r\n//         this.setState({ attributes });\r\n//     }\r\n\r\n//     render() {\r\n//         const lang = \"nl_NL\";\r\n//         const { attributes } = this.state;\r\n\r\n//         return (\r\n//             <div>\r\n//                 <HomepageHeader />\r\n\r\n//                 <main>\r\n//                     <h1>Credentials</h1>\r\n//                     {attributes.map(c =>\r\n//                         <Link to={`/detail/${encodeURIComponent(c.hash)}`} key={c.hash}>\r\n//                             <CredentialCard\r\n//                                 imageUrl={c.provider.logo_url}\r\n//                                 title={c.title[lang]}\r\n//                                 issuerName={c.provider.title[lang]}\r\n//                             />\r\n//                         </Link>\r\n//                     )}\r\n//                 </main>\r\n\r\n//                 <BottomTools showQR={true} showPlus={true} />\r\n\r\n//             </div>\r\n//         )\r\n\r\n//     }\r\n// }\r\n\r\ninterface State {\r\n    attributes: LocalAttr[];\r\n}\r\n","import { Attestation, InboundAttestationRequest, InboundVerificationRequest, VerificationOutputPair } from \"@tsow/ow-ssi/dist/types/src/ipv8/api/types\";\r\nimport React, { useEffect, useState } from 'react';\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\nimport { usePromised } from \"../hooks/usePromised\";\r\nimport { useServices } from \"../hooks/useServices\";\r\n\r\nexport const DebugPage: React.FC = () => {\r\n\r\n    const myMid = usePromised(() => services!.ipv8Service.api.getMyId().catch(e => console.error(e)));\r\n    const { services } = useServices();\r\n\r\n    const [polls, setPolls] = useState<PollState>({\r\n        attReqs: [], atts: [], verifReqs: [], verifs: [], peers: [],\r\n    })\r\n\r\n    useEffect(() => {\r\n        const o = services!.ipv8Service.observer;\r\n        const i = setInterval(() => {\r\n            setPolls({\r\n                attReqs: o.attReqPoller.cache,\r\n                atts: o.attPoller.cache,\r\n                verifReqs: o.verifReqPoller.cache,\r\n                verifs: o.verifPoller.cache,\r\n                peers: o.peerPoller.cache,\r\n            })\r\n        }, 300)\r\n        return () => clearInterval(i);\r\n    })\r\n\r\n    return (\r\n        <div className=\"subpage nav-compact\">\r\n\r\n            <SubpageHeader\r\n                pageTitle={\"Debug Page\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main>\r\n                <p>My Id: {myMid}</p>\r\n                <h1>Peers ({polls.peers.length})</h1>\r\n                <ul>\r\n                    {polls.peers.map(a => <li>- {a}</li>)}\r\n                </ul>\r\n\r\n                <h1>Attestations ({polls.atts.length})</h1>\r\n                <ul>\r\n                    {polls.atts.map(a => <li>\r\n                        Hash: {a.attribute_hash}<br />\r\n                    Name: {a.attribute_name}<br />\r\n                    Meta: {a.metadata}<br />\r\n                    Signer: {a.signer_mid_b64}<hr />\r\n                    </li>)}\r\n                </ul>\r\n\r\n                <h1>Incoming Attestations Requests ({polls.attReqs.length})</h1>\r\n                <ul>\r\n                    {polls.attReqs.map(a => <li>\r\n                        Name: {a.attribute_name}<br />\r\n                    Meta: {a.metadata}<br />\r\n                    Subject Mid: {a.mid_b64}\r\n                    </li>)}\r\n                </ul>\r\n\r\n                <h1>Verifications ({polls.verifs.length})</h1>\r\n                <ul>\r\n                    {polls.verifs.map(a => <li>\r\n                        Attribute Hash: {a.attribute_hash}<br />\r\n                    Value Hash: {a.value_hash}<br />\r\n                        Probability: {a.probability}\r\n                    </li>)}\r\n                </ul>\r\n\r\n                <h1>Incoming Verification Requests ({polls.verifReqs.length})</h1>\r\n                <ul>\r\n                    {polls.verifReqs.map(a => <li>\r\n                        Attribute Name: {a.attribute_name}<br />\r\n                    Verifier Mid: {a.mid_b64}\r\n\r\n                    </li>)}\r\n                </ul>\r\n            </main>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface PollState {\r\n    attReqs: InboundAttestationRequest[],\r\n    atts: Attestation[],\r\n    verifReqs: InboundVerificationRequest[],\r\n    verifs: VerificationOutputPair[],\r\n    peers: string[],\r\n}\r\n","import QRCode from \"qrcode.react\";\r\nimport React, { useState } from 'react';\r\nimport QrReader from \"react-qr-reader\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Button } from \"../components/Button\";\r\nimport { Icon } from \"../components/Icon\";\r\nimport { SubpageHeader } from \"../components/SubpageHeader\";\r\n\r\nexport const QrReaderPage: React.FC<Props> = ({ onScanQR }) => {\r\n\r\n    const [lastScan, setLastScan] = useState<string>(\"\");\r\n    const handleScan = (data: string | null) => {\r\n        if (data) {\r\n            setLastScan(data);\r\n        }\r\n    }\r\n\r\n    const handleError = (err: any) => {\r\n        console.error(err)\r\n    }\r\n\r\n    const [manualInput, setManualInput] = useState<string>(\"\");\r\n    const [showManual, setShowManual] = useState<boolean>(false);\r\n\r\n    return (\r\n        <div className=\"subpage nav-compact\">\r\n            <SubpageHeader\r\n                pageTitle={\"Scan QR\"}\r\n                backUrl={\"/\"}\r\n            />\r\n\r\n            <main className={\"text-center\"}>\r\n                <h1>Scan a QR</h1>\r\n\r\n                {!showManual ? (\r\n                    !lastScan ? (\r\n                        <div>\r\n                            <p>Find or draw a <Icon qrcode /> and scan it.</p>\r\n                            <QrReader\r\n                                delay={300}\r\n                                onError={handleError}\r\n                                onScan={handleScan}\r\n                                style={{ width: '100%' }}\r\n                            />\r\n                            <p className=\"clickable\" onClick={() => setShowManual(true)}>Or try entering manually</p>\r\n                        </div>\r\n                    ) : (\r\n                            <div>\r\n                                <p>I got this:</p>\r\n                                <QRCode value={lastScan} size={256} level={\"M\"} />\r\n                                <p>Meaning: <code>{lastScan}</code></p>\r\n                                <Button primary onClick={() => onScanQR(lastScan)}>Submit</Button>\r\n                                <Button onClick={() => setLastScan(\"\")}>Try again</Button>\r\n                            </div>\r\n                        )\r\n                ) : (\r\n                        <form onSubmit={() => onScanQR(manualInput)}>\r\n                            <div className=\"col-xs-12\">\r\n                                <input type=\"text\" className=\"text-input\" placeholder=\"Enter the QR value\"\r\n                                    required value={manualInput} onChange={(e) => setManualInput(e.target.value)} />\r\n                                <br />\r\n                                <br />\r\n                                <Button type={\"submit\"} primary>Submit</Button>\r\n                                <Button onClick={() => setShowManual(false)}>Cancel</Button>\r\n\r\n                            </div>\r\n                        </form>\r\n                    )}\r\n\r\n                <br /><br />\r\n                <Link to={\"/\"}><Button>Never mind</Button></Link>\r\n\r\n            </main>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    onScanQR: (qr: string) => any;\r\n}\r\n","import React from 'react';\r\nimport { HashRouter as Router, Route, Switch, useHistory, useParams } from \"react-router-dom\";\r\nimport './assets/css/font-awesome.min.css';\r\nimport './assets/css/index.css';\r\nimport { Sidemenu } from \"./components/Sidemenu\";\r\nimport { DemoPage } from \"./demo\";\r\nimport { CredentialCreateFlow } from \"./flows/CredentialCreateFlow\";\r\nimport { CredentialVerifyFlow } from \"./flows/CredentialVerifyFlow\";\r\nimport { useServices } from \"./hooks/useServices\";\r\nimport { DecodeStatus } from \"./modules/QR/GenericDecoding\";\r\nimport { ConfirmContactPage } from \"./pages/ConfirmContactPage\";\r\nimport { ConfirmIncomingVerificationPage } from \"./pages/ConfirmIncomingVerificationPage\";\r\nimport { ContactDetailPage } from \"./pages/ContactDetailPage\";\r\nimport { ContactIndexPage } from \"./pages/ContactIndexPage\";\r\nimport { CredentialDetailPage } from \"./pages/CredentialDetailPage\";\r\nimport { CredentialIndexPage } from \"./pages/CredentialIndexPage\";\r\nimport { DebugPage } from \"./pages/DebugPage\";\r\nimport { QrReaderPage } from \"./pages/QrReaderPage\";\r\nimport { qrDecoder } from \"./services/QRService\";\r\n\r\nexport const App: React.FC = () => <Router><AppBody /></Router>\r\n\r\nexport const AppBody: React.FC = () => {\r\n\r\n    const { ready, error } = useServices();\r\n\r\n    const history = useHistory();\r\n    const onScanQR = (val: string) => {\r\n        const res = qrDecoder.decode(val);\r\n        if (res.status === DecodeStatus.Succeeded) {\r\n            history.push(\"/verify/\" + encodeURIComponent(JSON.stringify(res.result)));\r\n        }\r\n    }\r\n\r\n    return !ready ? (error ? <div>Oops! Is the localhost offline?</div> : <div>Connecting to services..</div>) : (\r\n        <div>\r\n            <Sidemenu />\r\n\r\n            <Switch>\r\n                <Route path=\"/debug\"><DebugPage /></Route>\r\n                <Route path=\"/x\"><DemoPage /></Route>\r\n                <Route path=\"/create\"><CredentialCreateFlow /></Route>\r\n                <Route path=\"/verify/:offer\"><SpecificCredentialVerifyFlow /></Route>\r\n                <Route path=\"/detail/:id\"><SpecificCredentialDetailPage /></Route>\r\n                <Route path=\"/contacts/:mid\"><SpecificContactDetailPage /></Route>\r\n                <Route path=\"/contacts\"><ContactIndexPage /></Route>\r\n                <Route path=\"/confirm-contact\"><ConfirmContactPage /></Route>\r\n                <Route path=\"/confirm-verify\"><ConfirmIncomingVerificationPage /></Route>\r\n                <Route path=\"/qr\"><QrReaderPage onScanQR={onScanQR} /></Route>\r\n                <Route path=\"/\"><CredentialIndexPage /></Route>\r\n            </Switch>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction SpecificCredentialVerifyFlow() {\r\n    let params: any = useParams();\r\n    return <CredentialVerifyFlow verifyOffer={JSON.parse(decodeURIComponent(params.offer))} />\r\n}\r\n\r\nfunction SpecificCredentialDetailPage() {\r\n    let params: any = useParams();\r\n    return <CredentialDetailPage id={decodeURIComponent(params.id)} />\r\n}\r\n\r\nfunction SpecificContactDetailPage() {\r\n    let params: any = useParams();\r\n    return <ContactDetailPage providerMid={decodeURIComponent(params.mid)} />\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from \"./App\";\nimport { I18nContextProvider } from \"./hooks/useInternationalization\";\nimport { LocalStateContextProvider } from \"./hooks/useLocalState\";\nimport { MenuContextProvider } from \"./hooks/useMenu\";\nimport { ServicesContextProvider } from \"./hooks/useServices\";\nimport { initServices, localhostBase, localState } from \"./services/services\";\nimport * as serviceWorker from './serviceWorker';\n\nconst root = (\n    <ServicesContextProvider initServices={initServices} path={localhostBase}>\n        <MenuContextProvider>\n            <I18nContextProvider fallbackLangs={[\"en_US\", \"en_UK\"]}>\n                <LocalStateContextProvider localState={localState}>\n                    <App />\n                </LocalStateContextProvider>\n            </I18nContextProvider>\n        </MenuContextProvider>\n    </ServicesContextProvider>\n);\n\nReactDOM.render(root, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}